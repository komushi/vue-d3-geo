(function(t){function e(e){for(var n,i,l=e[0],s=e[1],d=e[2],u=0,p=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);c&&c(e);while(p.length)p.shift()();return o.push.apply(o,d||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],n=!0,l=1;l<r.length;l++){var s=r[l];0!==a[s]&&(n=!1)}n&&(o.splice(e--,1),t=i(i.s=r[0]))}return t}var n={},a={app:0},o=[];function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var c=s;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"003a":function(t,e,r){"use strict";var n=r("6447"),a=r.n(n);a.a},"1e39":function(t,e,r){},2584:function(t,e,r){},"2e33":function(t,e,r){"use strict";var n=r("2584"),a=r.n(n);a.a},"3acb":function(t,e,r){"use strict";var n=r("623b"),a=r.n(n);a.a},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",[r("button",{on:{click:t.clearHandler}},[t._v("clear")]),t._l(t.apiResponse,(function(e){return r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.geojsonString,expression:"geojsonString"}],attrs:{type:"radio",name:"area"},domProps:{value:e.geojson,checked:t._q(t.geojsonString,e.geojson)},on:{change:function(r){t.geojsonString=e.geojson}}}),t._v(" "+t._s(e.area)+" ")])})),r("button",{on:{click:t.highlightHandler}},[t._v("highlight")])],2),r("div",{staticStyle:{width:"100%",height:"800px"}},[r("d3-geo-leaf-polygon",{attrs:{"tile-provider":"Stamen.TonerLite","geojson-object":t.featureStatistics,color:"#FF6600","auto-fit-bounds":!0,"highlighted-meshes":t.meshes},on:{dragend:t.onDragEnd,zoomend:t.onZoomEnd,initmap:t.onInit}})],1)])},o=[],i=(r("fb6a"),r("d3b7"),r("25f0"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div")}),l=[],s=(r("a9e3"),r("ac1f"),r("1276"),r("5698")),d=r("3fe2"),c=function(t,e){var r,n,a=e.split(".");for(r=0,n=a.length;r<n;r++){if(!t.hasOwnProperty(a[r]))return;t=t[a[r]]}return t},u={topojsonPath:{type:String},width:{type:[String,Number],default:1e3},height:{type:[String,Number],default:1e3},colorRange:{type:String,default:"#0d47a1,#e3f2fd"},center:{type:String,default:"139.752268, 35.677043"},scale:{type:[String,Number],default:11e4},layerObjects:{type:String,default:"districts"},layerFeatureName:{type:String,default:"properties.district"},layerFeatureCode:{type:String,default:"properties.district_code"},featureNameStyle:{type:String,default:"static"}},p={name:"d3-geo-staic",props:u,mounted:function(){var t=this.layerObjects,e=this.colorRange,r=this.layerFeatureCode,n=this.layerFeatureName,a=this.featureNameStyle,o=s["k"](this.$el).append("svg").attr("width",this.width).attr("height",this.height),i=o.append("g"),l=i.append("g").attr("id",this.layerObjects),u=i.append("g").attr("id",this.layerObjects+"_label");console.log("this.center:",this.center);var p=s["c"]().center(this.center.split(",")).scale(this.scale).translate([this.width/2,this.height/2]),f=s["d"]().projection(p);s["g"](this.topojsonPath).then((function(o){console.log("layerObjects:",t);var p=d["a"](o,o.objects[t]).features,g=d["b"](o,o.objects[t],(function(t,e){return t!==e})),h=s["j"]().domain([1,p.length]).interpolate(s["f"]).range(e.split(",")),y=i.append("defs").attr("id",t+"_hdef").selectAll("radialGradient").data(p).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","100%").attr("id",(function(t){return"hgrad"+c(t,r)}));y.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),y.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return h(e+1)})).style("stop-opacity","1");var m=i.append("defs").attr("id",t+"_def").selectAll("radialGradient").data(p).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id",(function(t){return"grad"+c(t,r)}));if(m.append("stop").attr("offset","0%").style("stop-color",(function(t,e){return h(e+1)})).style("stop-opacity",".8"),m.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return h(e+1)})).style("stop-opacity","1"),"static"==a){var v=function(t){s["k"](this).style("fill",(function(t){return"url(#hgrad"+c(t,r)+")"}))},b=function(t){s["k"](this).style("fill",(function(t){return"url(#grad"+c(t,r)+")"}))};l.selectAll("path").data(p).enter().append("path").attr("d",f).attr("fill",(function(t){return"url(#grad"+c(t,r)+")"})).attr("layer-feature-code",(function(t){return c(t,r)})).attr("layer-feature-name",(function(t){return c(t,n)})).on("mouseover",v).on("mouseout",b),l.append("path").datum(g).attr("d",f).attr("class","layer1-boundary"),u.selectAll("text").data(p).enter().append("text").attr("class","label").attr("pointer-events","none").attr("transform",(function(t){return"translate("+f.centroid(t)+")"})).attr("dy",".35em").text((function(t){return c(t,n)})).attr("layer-feature-code",(function(t){return c(t,r)}))}}))}},f=p,g=(r("c403"),r("2877")),h=Object(g["a"])(f,i,l,!1,null,null,null),y=h.exports,m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div")},v=[],b=(r("4de4"),{id:{type:String,required:!0},topojsonPath:{type:String},width:{type:[String,Number],default:1e3},height:{type:[String,Number],default:1e3},colorRange:{type:String,default:"#e3f2fd,#2196f3,#0d47a1"},center:{type:String,default:"139.752268, 35.677043"},scale:{type:[String,Number],default:11e4},layer1Objects:{type:String,default:"districts"},layer2Objects:{type:String,default:"blocks"},layer1FeatureName:{type:String,default:"properties.district"},layer1FeatureCode:{type:String,default:"properties.district_code"},layer2FeatureName:{type:String,default:"properties.block"},layer2FeatureCode:{type:String,default:"properties.block_code"},layer1EventData:{type:Object},layer2EventData:{type:Array},layer1EventCountTag:{type:String,default:"dropoffCount"},layer1LegendTitle:{type:String,default:"Drop-off events in the last 30 minutes"}}),j={name:"d3-geo-double-layer",data:function(){return{legendWidth:0,projection:{}}},props:b,mounted:function(){var t=this,e=s["k"](this.$el).append("svg").attr("width",t.width).attr("height",t.height);e.append("rect").attr("class","background").attr("width",t.width).attr("height",t.height).on("click",x);var r=e.append("g").attr("id","base"),n=r.append("g").attr("id","layer2"),a=r.append("g").attr("id","layer1"),o=r.append("g").attr("id","layer2_label"),i=r.append("g").attr("id","layer1_label");this.projection=s["c"]().center(t.center.split(",")).scale(t.scale).translate([t.width/2,t.height/2]);var l=s["d"]().projection(this.projection),u=r.append("defs").attr("id","common_grads_def"),p=u.append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id","circleGrad1");p.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),p.append("stop").attr("offset","100%").style("stop-color",(function(t){return"orange"})).style("stop-opacity",".6");var f=t.getCountPoints(1,t.width,10),g=t.getCountScale(1,t.width);u.append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(s["i"](10)).enter().append("stop").attr("offset",(function(e,r){return g(f[r])/t.width})).attr("stop-color",(function(e,r){return t.colorRange.split(",")[0]}));r.node().getBBox();t.legendWidth=Math.min(.8*t.width,600);var h=r.append("g").attr("id","legendWrapper").attr("transform","translate("+t.width/2+","+.95*t.height+")");h.append("rect").attr("id","legendRect").attr("x",-t.legendWidth/2).attr("y",0).attr("width",t.legendWidth).attr("height",10).style("fill","url(#legend-traffic)"),h.append("text").attr("class","layer1LegendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(t.layer1LegendTitle);var y=t.getXAxis(t.legendWidth,0);h.append("g").attr("id","axis").attr("transform","translate(0,10)").call(y),s["g"](this.topojsonPath).then((function(e){var u=d["a"](e,e.objects[t.layer1Objects]).features,p=d["a"](e,e.objects[t.layer2Objects]).features,f=d["b"](e,e.objects[t.layer1Objects],(function(t,e){return t!==e})),g=t.colorRange.split(",")[0],h=r.append("defs").attr("id","layer1_hgrads").selectAll("radialGradient").data(u).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","100%").attr("id",(function(e,r){return"hgrad"+c(e,t.layer1FeatureCode)}));h.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),h.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return g})).style("stop-opacity","1");var y=r.append("defs").attr("id","layer1_grads").selectAll("radialGradient").data(u).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id",(function(e,r){return"grad"+c(e,t.layer1FeatureCode)}));y.append("stop").attr("offset","0%").style("stop-color",(function(t,e){return g})).style("stop-opacity",".7"),y.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return g})).style("stop-opacity","1");var m=function(e){console.log("mouseoverLayer1"),s["k"](this).style("fill",(function(e){return"url(#hgrad"+c(e,t.layer1FeatureCode)+")"}))},j=function(e){s["k"](this).style("fill",(function(e){return"url(#grad"+c(e,t.layer1FeatureCode)+")"}))};n.selectAll("path").data(p).enter().append("path").attr("d",l).attr("fill",(function(e,r){return"url(#grad"+c(e,t.layer1FeatureCode)+")"})).style("fill-opacity",0).style("display","none").attr("layer1-feature-code",(function(e){return c(e,t.layer1FeatureCode)})).attr("layer1-feature-name",(function(e){return c(e,t.layer1FeatureName)})).attr("layer2-feature-code",(function(e){return c(e,t.layer2FeatureCode)})).attr("layer2-feature-name",(function(e){return c(e,t.layer2FeatureName)})).attr("class","layer2").on("click",v).on("mouseover",_).on("mouseout",C),o.selectAll("text").data(p).enter().append("text").attr("class","label").style("fill-opacity",0).style("display","none").attr("transform",(function(t){return"translate("+l.centroid(t)+")"})).attr("dy",".35em").attr("pointer-events","none").text((function(e){return c(e,t.layer2FeatureName)})).attr("layer2-feature-code",(function(e){return c(e,t.layer2FeatureCode)})),a.selectAll("path").data(u).enter().append("path").attr("class","layer1").attr("d",l).style("fill",(function(e,r){return"url(#grad"+c(e,t.layer1FeatureCode)+")"})).attr("layer1-feature-code",(function(e){return c(e,t.layer1FeatureCode)})).attr("layer1-feature-name",(function(e){return c(e,t.layer1FeatureName)})).on("click",b).on("mouseover",m).on("mouseout",j),a.append("path").datum(f).attr("d",l).attr("class","layer1-boundary"),i.selectAll("text").data(u).enter().append("text").attr("class","label").attr("transform",(function(t){return"translate("+l.centroid(t)+")"})).attr("dy",".35em").attr("pointer-events","none").text((function(e){return c(e,t.layer1FeatureName)})).attr("layer1-feature-code",(function(e){return c(e,t.layer1FeatureCode)}))}));var m=s["k"](null),v=function(t){if(console.log("layer2Clicked"),m.node()&&this.getAttribute("layer1-feature-code")==m.node().getAttribute("layer1-feature-code"))return x()},b=function(t){if(console.log("layer1Clicked"),m.node()===this)return x();m.classed("active",!1),m=s["k"](this).classed("active",!0),j(t)},j=function(e){var a=l.bounds(e),o=a[1][0]-a[0][0],s=a[1][1]-a[0][1],d=(a[0][0]+a[1][0])/2,u=(a[0][1]+a[1][1])/2,p=.9/Math.max(o/t.width,s/t.height),f=[t.width/2-p*d,t.height/2-p*u];r.transition().duration(750).style("stroke-width",1.5/p+"px").attr("transform","translate("+f+")scale("+p+")"),i.selectAll("text").transition().style("fill-opacity",0).transition().style("display","none"),n.selectAll("path").transition().style("fill-opacity",1).style("display","block");var g=c(e,t.layer1FeatureCode);t.$emit("on-stop-events"),t.$emit("on-receive-events",g)};function x(){m.classed("active",!1),m=s["k"](null),r.transition().duration(750).style("stroke-width","1.5px").attr("transform",""),i.selectAll("text").transition().style("display","block").transition().duration(250).style("fill-opacity",1),n.selectAll("path").transition().style("fill-opacity",0).style("display","none"),t.$emit("on-stop-events")}var _=function(e){console.log("mouseoverLayer2"),o.selectAll("text").filter((function(r){return console.log("p",c(e,t.layer2FeatureCode)),console.log("d",c(r,t.layer2FeatureCode)),c(e,t.layer2FeatureCode)==c(r,t.layer2FeatureCode)})).transition().style("fill-opacity",1).style("display","block"),s["k"](this).style("fill",(function(e){return"url(#hgrad"+c(e,t.layer1FeatureCode)+")"}))},C=function(e){o.selectAll("text").filter((function(r){return c(e,t.layer2FeatureCode)==c(r,t.layer2FeatureCode)})).transition().style("fill-opacity",0).transition().style("display","none"),s["k"](this).style("fill",(function(e){return"url(#grad"+c(e,t.layer1FeatureCode)+")"}))}},watch:{layer1EventData:function(t,e){this.visualizeLayer1Events(t)},layer2EventData:function(t,e){this.visualizeLayer2Events(t)}},methods:{visualizeLayer1Events:function(t){var e=this,r=s["b"](t),n=s["h"](r,(function(t){return t.value[e.layer1EventCountTag]})),a=e.getColorScale(n,e.colorRange),o=e.getCountPoints(n,e.width,10);s["k"]("#common_grads_def").selectAll("linearGradient").selectAll("stop").attr("stop-color",(function(t,e){return a(o[e])}));var i=e.getXAxis(e.legendWidth,n);s["k"]("#axis").selectAll(".tick").remove(),s["k"]("#axis").call(i),s["k"]("#layer1").selectAll("path").filter((function(r){if("Feature"===r.type){var n=c(r,e.layer1FeatureCode),a=t[n];if(!a)return r[e.layer1EventCountTag]=1,!0;var o=a[e.layer1EventCountTag];if(!r[e.layer1EventCountTag])return r[e.layer1EventCountTag]=o,!0;if(o!=r[e.layer1EventCountTag])return r[e.layer1EventCountTag]=o,!0}return!1})),s["k"]("#layer1_grads").selectAll("radialGradient").selectAll("stop").style("stop-color",(function(t,r){return a(t[e.layer1EventCountTag])})),s["k"]("#layer1_hgrads").selectAll("radialGradient").selectAll("stop").filter((function(t){return"100%"===this.getAttribute("offset")})).style("stop-color",(function(t,r){return a(t[e.layer1EventCountTag])})),s["k"]("#layer1").selectAll("path").filter((function(t){return"Feature"===t.type})).style("fill",(function(t,r){return"url(#grad"+c(t,e.layer1FeatureCode)+")"}))},visualizeLayer2Events:function(t){console.log(t);var e=this;s["k"]("#base").selectAll("circle").data(t).enter().append("circle").style("opacity",0).attr("class","circle").style("fill",(function(t,e){return"url(#circleGrad1)"})).attr("cx",(function(t){return e.projection(t)[0]})).attr("cy",(function(t){return e.projection(t)[1]})).attr("r",2).transition().delay((function(t,e){return 100*e})).style("opacity",1).transition().delay((function(t,e){return 100*e+250+100})).style("opacity",0).remove()},getCountScale:function(t,e){return s["j"]().domain([0,t]).range([0,e])},getCountPoints:function(t,e,r){var n=this.getCountScale(t,r),a=n.domain();a[2]=a[1]-a[0];for(var o=[],i=0;i<r;i++)o.push(i*a[2]/(r-1)+a[0]);return o},getColorScale:function(t,e){return s["j"]().domain([0,t/2,t]).range(e.split(","))},getXAxis:function(t,e){var r=s["j"]().range([-t/2,t/2]).domain([0,e]);return s["a"]().ticks(5).scale(r)}}},x=j,_=(r("003a"),Object(g["a"])(x,m,v,!1,null,null,null)),C=_.exports,S=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div")},A=[],w=(r("4160"),r("c975"),r("159b"),{id:{type:String,required:!0},topojsonPath:{type:String},width:{type:[String,Number],default:1e3},height:{type:[String,Number],default:1e3},bgColor:{type:String,default:"#bbdefb"},colorRange:{type:String,default:"#227AFF,#FFF500"},topNumber:{type:[String,Number],default:10},center:{type:String,default:"139.752268, 35.677043"},scale:{type:[String,Number],default:15e4},layerObjects:{type:String,default:"blocks"},layerFeatureName:{type:String,default:"properties.block"},layerFeatureCode:{type:String,default:"properties.block_code"},layerEventData:{type:Array}}),O={name:"d3-geo-events",data:function(){return{projection:{}}},props:w,mounted:function(){var t=this,e=s["k"](this.$el).append("svg").attr("width",t.width).attr("height",t.height),r=e.append("g").attr("id","base"),n=r.append("g").attr("id",t.layerObjects),a=r.append("g").attr("id",t.layerObjects+"_label");this.projection=s["c"]().center(t.center.split(",")).scale(t.scale).translate([t.width/2,t.height/2]);var o=s["d"]().projection(this.projection),i=t.getColorScale(t.topNumber,t.colorRange),l=r.append("defs").attr("id","from_def").selectAll("linearGradient").data(s["i"](1,parseInt(t.topNumber)+1)).enter().append("linearGradient").attr("gradientUnits","objectBoundingBox").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%").attr("id",(function(t,e){return"fromGrad"+(e+1)}));l.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),l.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return i(e+1)})).style("stop-opacity","1");var u=r.append("defs").attr("id","to_def").selectAll("linearGradient").data(s["i"](1,parseInt(t.topNumber)+1)).enter().append("linearGradient").attr("gradientUnits","objectBoundingBox").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("id",(function(t,e){return"toGrad"+(e+1)}));u.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),u.append("stop").attr("offset","100%").style("stop-color",(function(t,e){return i(e+1)})).style("stop-opacity","1"),s["g"](this.topojsonPath).then((function(e){var r=d["a"](e,e.objects[t.layerObjects]).features,i=d["b"](e,e.objects[t.layerObjects],(function(t,e){return t!==e}));n.selectAll("path").data(r).enter().append("path").attr("d",o).attr("fill",t.bgColor).attr("layer-feature-code",(function(e){return c(e,t.layerFeatureCode)})),n.append("path").datum(i).attr("d",o).attr("class","layer1-boundary"),a.selectAll("text").data(r).enter().append("text").attr("class","label").attr("transform",(function(t){return"translate("+o.centroid(t)+")"})).attr("dy","-1em")}))},watch:{layerEventData:function(t,e){var r=this;this.hideFeatureNames().then((function(){t&&r.showFeatureNames(t)})),this.dehighlightFeatures().then((function(){t&&r.highlightFeatures(t)}))}},methods:{hideFeatureNames:function(){var t=this,e=s["k"]("#"+t.layerObjects+"_label");return new Promise((function(t,r){var n=e.selectAll("text").filter((function(t){return t.hasOwnProperty("showname")}));if(0==n.size())t();else{var a=0;n.transition().style("fill-opacity",0).transition().text((function(t){return t.hasOwnProperty("showname")&&delete t.showname,""})).attr("style",null).each((function(){++a})).on("end",(function(){--a||t()}))}}))},showFeatureNames:function(t){var e=this,r=s["k"]("#"+e.layerObjects+"_label"),n=this.extractCodes(t,"from_code"),a=this.extractCodes(t,"to_code");r.selectAll("text").filter((function(t){return n.indexOf(c(t,e.layerFeatureCode))>-1||a.indexOf(c(t,e.layerFeatureCode))>-1})).text((function(t){var r=n.indexOf(c(t,e.layerFeatureCode)),o=a.indexOf(c(t,e.layerFeatureCode));return r>-1?r+1+"_"+c(t,e.layerFeatureName):o>-1?o+1+"_"+c(t,e.layerFeatureName):void 0})).transition().style("fill-opacity",1).style("display","block").style("fill",(function(t,r){t.showname=!0;var o=n.indexOf(c(t,e.layerFeatureCode)),i=a.indexOf(c(t,e.layerFeatureCode));return o>-1?"url(#fromGrad"+(o+1)+")":i>-1?"url(#toGrad"+(i+1)+")":void 0}))},dehighlightFeatures:function(t){var e=this,r=s["k"]("#"+e.layerObjects);return new Promise((function(t,n){var a=r.selectAll("path").filter((function(t){return t.hasOwnProperty("highlight")}));if(0==a.size())t();else{var o=0;a.transition().attr("fill",(function(t){return delete t.highlight,e.bgColor})).each((function(){++o})).on("end",(function(){--o||t()}))}}))},highlightFeatures:function(t){var e=this,r=e.extractCodes(t,"from_code"),n=e.extractCodes(t,"to_code"),a=e.getColorScale(e.topNumber,e.colorRange),o=s["k"]("#"+e.layerObjects);o.selectAll("path").filter((function(t){return r.indexOf(c(t,e.layerFeatureCode))>-1||n.indexOf(c(t,e.layerFeatureCode))>-1})).transition().attr("fill",(function(t,o){t.highlight=!0;var i=r.indexOf(c(t,e.layerFeatureCode)),l=n.indexOf(c(t,e.layerFeatureCode));return i>-1?a(i+1):l>-1?a(l+1):void 0}))},extractCodes:function(t,e){var r=[];return t?(t.forEach((function(t){r.push(t[e])})),r):r},getColorScale:function(t,e){return s["j"]().domain([1,t]).interpolate(s["f"]).range(e.split(","))}}},k=O,F=(r("80a1"),Object(g["a"])(k,S,A,!1,null,null,null)),T=F.exports,B=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"leaflet",style:{height:"100%",width:"100%"},attrs:{id:"leaflet"}})},L=[],P=(r("d81d"),r("6cc5"),r("e11e")),E=r.n(P),N=(r("e5e0"),{tileProvider:{type:String,default:"CartoDB.Voyager"},geojsonPath:{type:String},geojsonObject:{type:Object},legendWidth:{type:[String,Number],default:500},colorRange:{type:String,default:"#0000ff,#e623e4,#ff0000"},mapCenter:{type:String,default:"139.77887823700362, 35.69026554219554"},mapZoom:{type:[String,Number],default:17},legendCenter:{type:String,default:"400, 50"},geojsonType:{type:String,default:"lines"},countTag:{type:String,default:"collected"},idTag:{type:String,default:"id"},legendTitle:{type:String,default:"Collected Count Per Feature"},autoFitBounds:{type:Boolean,default:!1}}),G={name:"d3-geo-leaf",data:function(){return{map:null,svg:null,mapAdded:!1,svgAdded:!1}},props:N,computed:{legendCenterObj:function(){return{x:parseInt(this.legendCenter.split(",")[0]),y:parseInt(this.legendCenter.split(",")[1])}}},watch:{geojsonObject:{handler:function(t,e){t?this.renderMap():this.clearSvg()},deep:!0}},mounted:function(){this.renderMap()},methods:{clearSvg:function(){var t=this,e=s["k"](t.map.getPane("overlayPane")).select("svg"),r=e.select("g");r.selectAll("g[id=".concat(this.geojsonType,"]")).remove(),r.selectAll("g[id=".concat(this.geojsonType,"_label]")).remove(),r.selectAll("defs[id=color_grads_def]").remove(),r.selectAll("g[id=legend_wrapper]").remove()},renderMap:function(){var t=this,e=this;if(this.mapAdded?this.autoFitBounds&&e.map.fitBounds(E.a.geoJson(this.geojsonObject).getBounds()):(this.geojsonObject?e.map=E.a.map(this.$refs["leaflet"]).fitBounds(E.a.geoJson(this.geojsonObject).getBounds()):(e.map=E.a.map(this.$refs["leaflet"]),e.map.setView(new E.a.LatLng(this.mapCenter.split(",")[1],this.mapCenter.split(",")[0]),this.mapZoom)),this.mapAdded=!0,E.a.tileLayer.provider(e.tileProvider).addTo(e.map),e.map.on("zoomend",(function(){t.$emit("zoomend",e.getBounds(e.map))})),e.map.on("dragend",(function(){t.$emit("dragend",e.getBounds(e.map))})),this.$emit("initmap",e.getBounds(e.map))),this.geojsonObject){var r=s["b"](this.geojsonObject.features),n=s["h"](r,(function(t){return t.value.properties[e.countTag]})),a=10,o=this.getCountPoints(n,this.legendWidth,a),i=this.getCountScale(n,this.legendWidth),l=this.getColorScale(n,this.colorRange),d=s["e"]({point:function(t,r){var n=e.map.latLngToLayerPoint(new E.a.LatLng(r,t));this.stream.point(n.x,n.y)}}),c=s["d"]().projection(d);this.svgAdded||(E.a.svg().addTo(e.map),this.svgAdded=!0);var u=s["k"](e.map.getPane("overlayPane")).select("svg"),p=u.select("g");p.selectAll("g[id=".concat(this.geojsonType,"]")).remove();var f=p.append("g").attr("id",this.geojsonType);p.selectAll("g[id=".concat(this.geojsonType,"_label]")).remove();var g=p.append("g").attr("id",this.geojsonType+"_label"),h=function(t,r){s["k"](this).style("cursor","pointer").style("stroke-width","5px"),g.selectAll("text").filter((function(r){return r.properties[e.idTag]==t.properties[e.idTag]})).transition().style("fill-opacity",1).style("display","block").attr("fill",(function(r,n){return l(t.properties[e.countTag])}))},y=function(t,r){s["k"](this).style("cursor","").style("stroke-width","3px"),g.selectAll("text").filter((function(r){return r.properties[e.idTag]==t.properties[e.idTag]})).transition().style("fill-opacity",0).transition().style("display","none")};f.selectAll("path").data(this.geojsonObject.features).enter().append("path").style("fill","none").style("stroke-width","3px").style("pointer-events","auto").attr("stroke",(function(t,r){return l(t.properties[e.countTag])})).on("mouseout",y).on("mouseover",h),g.selectAll("text").data(this.geojsonObject.features).enter().append("text").attr("class","geojsonLabel").attr("pointer-events","none").attr("transform",(function(t){return"translate("+c.centroid(t)+")"})).attr("dy",".35em").text((function(t){return t.properties[e.countTag]})),p.selectAll("defs[id=color_grads_def]").remove();var m=p.append("defs").attr("id","color_grads_def");m.append("linearGradient").attr("id","legendTraffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(s["i"](a)).enter().append("stop").attr("offset",(function(t,r){return i(o[r])/e.legendWidth})).attr("stop-color",(function(t,e){return l(o[e])})),p.selectAll("g[id=legend_wrapper]").remove();var v=p.append("g").attr("id","legend_wrapper").attr("transform","translate("+e.legendCenterObj.x+","+e.legendCenterObj.y+")");v.append("rect").attr("id","legend_rect").attr("x",-e.legendWidth/2).attr("y",0).attr("width",e.legendWidth).attr("height",10).style("fill","url(#legendTraffic)"),v.append("text").attr("class","legendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(e.legendTitle);var b=e.getXAxis(e.legendWidth,n),j=v.append("g").attr("id","axis").attr("transform","translate(0,10)");j.call(b),e.map.on("zoomend",(function(){x()})),e.map.on("dragend",(function(){x()}));var x=function(){p.selectAll("path").attr("d",c);var t=e.map.latLngToLayerPoint(new E.a.LatLng(e.map.getBounds()._northEast.lat,e.map.getBounds()._southWest.lng));p.selectAll("g[id=legend_wrapper]").attr("transform","translate("+(e.legendCenterObj.x+t.x)+","+(e.legendCenterObj.y+t.y)+")")};x()}},getBounds:function(t){return{lng_nw:t.getBounds()._southWest.lng,lat_nw:t.getBounds()._northEast.lat,lng_se:t.getBounds()._northEast.lng,lat_se:t.getBounds()._southWest.lat}},getCountScale:function(t,e){return s["j"]().domain([0,t]).range([0,e])},getCountPoints:function(t,e,r){var n=this.getCountScale(t,e),a=n.domain();a[2]=a[1]-a[0];for(var o=[],i=0;i<r;i++)o.push(i*a[2]/(r-1)+a[0]);return o},getXAxis:function(t,e){var r=s["j"]().range([-t/2,t/2]).domain([0,e]);return s["a"]().ticks(5).scale(r)},getColorScale:function(t,e){return s["j"]().domain([0,t/2,t]).range(e.split(","))}}},M=G,$=(r("2e33"),Object(g["a"])(M,B,L,!1,null,null,null)),D=$.exports,W=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"leaflet",style:{height:"100%",width:"100%"},attrs:{id:"leaflet"}})},R=[],z=(r("caad"),r("2532"),{tileProvider:{type:String,default:"CartoDB.Voyager"},geojsonObject:{type:Object},color:{type:String,default:"MidnightBlue"},colorOpacity:{type:String,default:"0.2"},mapCenter:{type:String,default:"139.77887823700362, 35.69026554219554"},mapZoom:{type:[String,Number],default:17},geojsonType:{type:String,default:"Polygon"},idTag:{type:String,default:"MESH_ID"},autoFitBounds:{type:Boolean,default:!1},hideLabelThreshold:{type:Number,default:100},highlightedMeshes:{type:Array}}),I={name:"d3-geo-leaf-polygon",data:function(){return{map:null,svg:null,mapAdded:!1,svgAdded:!1}},props:z,computed:{},watch:{geojsonObject:{handler:function(t,e){t?this.renderMap():this.clearSvg()},deep:!0},highlightedMeshes:{handler:function(t,e){t.length>0?this.highlightMesh():this.clearHighlight()},deep:!0}},mounted:function(){this.renderMap()},methods:{clearHighlight:function(){var t=this,e=s["k"](t.map.getPane("overlayPane")).select("svg"),r=e.select("g"),n=r.selectAll("g[id=".concat(this.geojsonType,"]"));n.selectAll("path").attr("fill-opacity","0")},highlightMesh:function(){var t=this,e=s["k"](t.map.getPane("overlayPane")).select("svg"),r=e.select("g"),n=r.selectAll("g[id=".concat(this.geojsonType,"]"));n.selectAll("path").attr("fill-opacity",0),n.selectAll("path").filter((function(e){return t.highlightedMeshes.map((function(t){return t.mesh_id})).includes(String(e.properties[t.idTag]))})).attr("fill-opacity",t.colorOpacity)},clearSvg:function(){var t=this,e=s["k"](t.map.getPane("overlayPane")).select("svg"),r=e.select("g");r.selectAll("g[id=".concat(this.geojsonType,"]")).remove(),r.selectAll("g[id=".concat(this.geojsonType,"_label]")).remove()},renderMap:function(){var t=this,e=this;if(this.mapAdded?this.autoFitBounds&&e.map.fitBounds(E.a.geoJson(this.geojsonObject).getBounds()):(this.geojsonObject?e.map=E.a.map(this.$refs["leaflet"]).fitBounds(E.a.geoJson(this.geojsonObject).getBounds()):(e.map=E.a.map(this.$refs["leaflet"]),e.map.setView(new E.a.LatLng(this.mapCenter.split(",")[1],this.mapCenter.split(",")[0]),this.mapZoom)),this.mapAdded=!0,E.a.tileLayer.provider(e.tileProvider).addTo(e.map),e.map.on("zoomend",(function(){t.$emit("zoomend",e.getBounds(e.map))})),e.map.on("dragend",(function(){t.$emit("dragend",e.getBounds(e.map))})),this.$emit("initmap",e.getBounds(e.map))),this.geojsonObject){var r=function(t,r){var n=e.map.latLngToLayerPoint(new E.a.LatLng(r,t));this.stream.point(n.x,n.y)},n=s["e"]({point:r}),a=s["d"]().projection(n);this.svgAdded||(E.a.svg().addTo(e.map),this.svgAdded=!0);var o=s["k"](e.map.getPane("overlayPane")).select("svg"),i=o.select("g").attr("class","leaflet-zoom-hide");i.selectAll("g[id=".concat(this.geojsonType,"]")).remove();var l=i.append("g").attr("id",this.geojsonType);i.selectAll("g[id=".concat(this.geojsonType,"_label]")).remove();var d=i.append("g").attr("id",this.geojsonType+"_label"),c=function(t,r){s["k"](this).style("cursor","pointer").style("stroke-width","3px"),d.selectAll("text").filter((function(r){return r.properties[e.idTag]==t.properties[e.idTag]})).transition().style("fill-opacity",1).style("display","block").attr("fill",(function(t,e){return"#000000"}))},u=function(t,r){s["k"](this).style("cursor","").style("stroke-width","1px");var n=l.select("path").node().getBBox();n.width<e.hideLabelThreshold&&d.selectAll("text").filter((function(r){return r.properties[e.idTag]==t.properties[e.idTag]})).transition().style("fill-opacity",0).transition().style("display","none")};l.selectAll("path").data(this.geojsonObject.features).enter().append("path").attr("fill-opacity","0.0").style("fill",e.color).style("stroke-width","1px").style("pointer-events","auto").attr("stroke",(function(t,r){return e.color})).on("mouseout",u).on("mouseover",c),this.geojsonObject.features.forEach((function(t){t.LatLng=new E.a.LatLng(t.geometry.coordinates[0][1][1],t.geometry.coordinates[0][1][0])}));var p=d.selectAll("text").data(this.geojsonObject.features).enter().append("text").attr("class","geojsonLabel").attr("pointer-events","none").attr("dx","2.5em").attr("dy","1em").style("fill-opacity",1).style("display","block").text((function(t){return t.properties[e.idTag]}));e.map.on("zoomend",(function(){f()})),e.map.on("dragend",(function(){f()}));var f=function(){l.selectAll("path").attr("d",a),p.attr("x",(function(t){return e.map.latLngToLayerPoint(t.LatLng).x})),p.attr("y",(function(t){return e.map.latLngToLayerPoint(t.LatLng).y}));var t=l.select("path").node().getBBox();t.width>=e.hideLabelThreshold?p.style("fill-opacity",1).style("display","block"):p.style("fill-opacity",0).style("display","none")};f()}},getBounds:function(t){return{lng_nw:t.getBounds()._southWest.lng,lat_nw:t.getBounds()._northEast.lat,lng_se:t.getBounds()._northEast.lng,lat_se:t.getBounds()._southWest.lat}}}},J=I,H=(r("3acb"),Object(g["a"])(J,W,R,!1,null,null,null)),U=H.exports,Z=r("bc3a"),X=r.n(Z),V={name:"app",components:{D3GeoStatic:y,D3GeoDoubleLayer:C,D3GeoEvents:T,D3GeoLeaf:D,D3GeoLeafPolygon:U},computed:{featureStatistics:function(){return this.geojsonString?JSON.parse(this.geojsonString):null}},data:function(){return{meshes:[],geojsonString:null,apiResponse:[],currentSubway:null,jsons:[],matrixJson:null,timer:0,districtRankList:null,circleData:null,coordinates:[[139.734291,35.688634],[139.760496,35.690335],[139.770401,35.694069],[139.765043,35.68835],[139.7661246316267,35.68825974504272],[139.7657681127479,35.687651654673644],[139.745212,35.691125],[139.759712,35.700672],[139.755267,35.693319],[139.761334,35.674706],[139.750424,35.670865],[139.7414532200372,35.679581104938],[139.749899,35.701827],[139.74692,35.696674],[139.740164,35.692643],[139.768072,35.687348],[139.75074,35.671377],[139.743383,35.697602],[139.764721,35.679816],[139.7507934778318,35.671386654224115],[139.7507934778318,35.671386654224115],[139.7507934778318,35.671386654224115],[139.743383,35.697602],[139.7507934778318,35.671386654224115],[139.76294,35.677412],[139.76585163985027,35.68940619519768],[139.761877,35.675639],[139.7507934778318,35.671386654224115],[139.746458,35.671899],[139.74692,35.696674],[139.746458,35.671899],[139.766939,35.683965],[139.737945,35.688772],[139.754544,35.669638],[139.757993,35.692478],[139.750962,35.672238],[139.765683,35.676349],[139.73610888396263,35.68553725865768],[139.73610888396263,35.685537258666734],[139.753961,35.690292],[139.757993,35.692478],[139.752018,35.671321],[139.757993,35.692478],[139.734048,35.684031],[139.742659,35.680767],[139.754544,35.669638],[139.753683,35.698596],[139.750424,35.670865],[139.765854,35.689364],[139.745793,35.692572],[139.745796,35.67096],[139.75463308702805,35.690506392289514],[139.757993,35.692478],[139.76441428407463,35.687749511028905],[139.742659,35.680767],[139.742659,35.680767],[139.754544,35.669638],[139.742824,35.675821],[139.742463,35.678098],[139.744685,35.676487],[139.742463,35.678098],[139.745074,35.675182],[139.7470116382056,35.678418885519754],[139.742463,35.678098],[139.74505617405612,35.67525922701384],[139.74465211932687,35.6765672952068],[139.74505617405615,35.675254401080785],[139.7484141620185,35.67166693581735],[139.752737,35.672691],[139.748046,35.673099],[139.742657,35.67882],[139.748046,35.673099],[139.748046,35.673099],[139.748046,35.673099],[139.748046,35.673099],[139.750157,35.676043],[139.748046,35.673099],[139.742657,35.67882],[139.748046,35.673099],[139.753073,35.673377],[139.745518,35.673015],[139.748046,35.673099],[139.7452951757008,35.67302465399794],[139.762711,35.689542],[139.7406821860937,35.67312691603093],[139.742657,35.67882],[139.742657,35.67882],[139.7453011176821,35.67295707637637],[139.762711,35.689542],[139.748046,35.673099],[139.742657,35.67882],[139.7453011176821,35.67295707637637],[139.743713,35.672988],[139.7541,35.683792],[139.74798931035463,35.67179002702629],[139.75461119813127,35.67567441585073],[139.74071189600025,35.67305209778313],[139.75124,35.675626],[139.75124,35.675626],[139.758656,35.685403]]}},methods:{onDragEnd:function(t){},onZoomEnd:function(t){},onInit:function(t){},subTaxiEventsFrom:function(t){var e=this;"101"==t&&(this.timer=setInterval((function(){var t,r=0,n=e.coordinates.length-1,a=Math.floor(Math.random()*(n-r+1))+r,o=Math.floor(Math.random()*(n-r+1))+r;t=a<=o?e.coordinates.slice(a,o):e.coordinates.slice(o,a),e.circleData=t}),1500))},unsubTaxiEvents:function(){clearInterval(this.timer)},generateData:function(){var t,e={},r=1;for(t=101;t<=123;t++){var n=0,a=500,o=Math.floor(Math.random()*(a-n+1))+n;e[t.toString()]={district:t,dropoffCount:o,rank:r},r++}return e},clearHandler:function(){this.meshes=[]},highlightHandler:function(){4!=this.meshes.length?this.meshes=[{mesh_id:"49395630"},{mesh_id:"53393483"},{mesh_id:"53385739"},{mesh_id:"53385759"}]:this.meshes=[{mesh_id:"49395630"},{mesh_id:"53385739"},{mesh_id:"53385759"}]}},mounted:function(){var t=this;setInterval((function(){t.districtRankList=t.generateData()}),1e3),X.a.get("data/event_data1.json").then((function(e){t.jsons.push(e.data.toptenlist)}),(function(t){})),X.a.get("data/event_data2.json").then((function(e){console.log(e),t.jsons.push(e.data.toptenlist)}),(function(t){}));setInterval((function(){var e=Math.floor(2*Math.random());t.matrixJson=t.jsons[e]}),1500),setTimeout((function(){X.a.get("data/tokyo_mesh.json").then((function(e){t.apiResponse=e.data}),(function(t){}))}),1e3)}},q=V,K=(r("fffb"),Object(g["a"])(q,a,o,!1,null,null,null)),Q=K.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(Q)}}).$mount("#app")},"623b":function(t,e,r){},6447:function(t,e,r){},"80a1":function(t,e,r){"use strict";var n=r("1e39"),a=r.n(n);a.a},a210:function(t,e,r){},c403:function(t,e,r){"use strict";var n=r("e35f"),a=r.n(n);a.a},e35f:function(t,e,r){},fffb:function(t,e,r){"use strict";var n=r("a210"),a=r.n(n);a.a}});
//# sourceMappingURL=app.acb27547.js.map