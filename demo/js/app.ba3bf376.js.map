{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/D3GeoDoubleLayer.vue?4816","webpack:///./src/components/D3GeoLeaf.vue?4330","webpack:///./src/components/D3GeoLeafPolygon.vue?f13f","webpack:///./src/app.vue?00ce","webpack:///./src/components/D3GeoStatic.vue?465e","webpack:///./src/utils/findprop.js","webpack:///src/components/D3GeoStatic.vue","webpack:///./src/components/D3GeoStatic.vue?2a91","webpack:///./src/components/D3GeoStatic.vue","webpack:///./src/components/D3GeoDoubleLayer.vue?f41a","webpack:///src/components/D3GeoDoubleLayer.vue","webpack:///./src/components/D3GeoDoubleLayer.vue?b3cd","webpack:///./src/components/D3GeoDoubleLayer.vue","webpack:///./src/components/D3GeoEvents.vue?2cdb","webpack:///src/components/D3GeoEvents.vue","webpack:///./src/components/D3GeoEvents.vue?e403","webpack:///./src/components/D3GeoEvents.vue","webpack:///./src/components/D3GeoLeaf.vue?9c47","webpack:///src/components/D3GeoLeaf.vue","webpack:///./src/components/D3GeoLeaf.vue?dfdc","webpack:///./src/components/D3GeoLeaf.vue","webpack:///./src/components/D3GeoLeafPolygon.vue?fa29","webpack:///src/components/D3GeoLeafPolygon.vue","webpack:///./src/components/D3GeoLeafPolygon.vue?b708","webpack:///./src/components/D3GeoLeafPolygon.vue","webpack:///src/app.vue","webpack:///./src/app.vue?b1d1","webpack:///./src/app.vue","webpack:///./src/main.js","webpack:///./src/components/D3GeoEvents.vue?777a","webpack:///./src/components/D3GeoStatic.vue?f536","webpack:///./src/app.vue?54a8"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","on","clearHandler","_v","_l","item","directives","rawName","expression","domProps","geojson","_q","geojsonString","$event","_s","area","highlightHandler","staticStyle","featureStatistics","meshes","onDragEnd","onZoomEnd","onInit","staticRenderFns","obj","path","args","split","topojsonPath","type","String","width","Number","default","height","colorRange","center","scale","layerObjects","layerFeatureName","layerFeatureCode","featureNameStyle","props","mounted","console","log","d3","hgrads","append","grads","mouseover","mouseout","gLayer","selectAll","gLabelLayer","component","id","required","layer1Objects","layer2Objects","layer1FeatureName","layer1FeatureCode","layer2FeatureName","layer2FeatureCode","layer1EventData","layer2EventData","Array","layer1EventCountTag","layer1LegendTitle","legendWidth","projection","svg","circleGrads","commonGrads","vm","Math","min","legendsvg","gLayer2","gLabelLayer2","gLayer1","gLabelLayer1","active","node","getAttribute","reset","classed","zoom","g","transition","$emit","featureCode","watch","visualizeLayer1Events","newData","visualizeLayer2Events","methods","getCountScale","getCountPoints","countRange","countPoints","getColorScale","getXAxis","bgColor","topNumber","layerEventData","fromGrads","toGrads","attr","hideFeatureNames","then","dehighlightFeatures","Promise","highlightData","size","resolve","showFeatureNames","highlightFeatures","extractCodes","routes","forEach","featureCodes","ref","style","tileProvider","geojsonPath","geojsonObject","mapCenter","mapZoom","legendCenter","geojsonType","countTag","idTag","legendTitle","autoFitBounds","Boolean","map","mapAdded","svgAdded","computed","legendCenterObj","renderMap","clearSvg","remove","fitBounds","setView","getBounds","properties","point","stream","x","y","gGeojsonLayer","axisLayer","xAxis","updatePath","lng_nw","_southWest","lng","lat_nw","_northEast","lat","lng_se","lat_se","color","colorOpacity","hideLabelThreshold","highlightedMeshes","clearHighlight","highlightMesh","bbox","features","LatLng","labels","latLngToLayerPoint","components","D3GeoStatic","D3GeoDoubleLayer","D3GeoEvents","D3GeoLeaf","D3GeoLeafPolygon","JSON","parse","apiResponse","currentSubway","jsons","matrixJson","timer","districtRankList","circleData","coordinates","subTaxiEventsFrom","payload","unsubTaxiEvents","clearInterval","generateData","districtRank","toString","rank","setInterval","setTimeout","Vue","config","productionTip","render","h","app","$mount"],"mappings":"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","file":"js/app.ba3bf376.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoDoubleLayer.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoDoubleLayer.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeaf.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeaf.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeafPolygon.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeafPolygon.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',[_c('button',{on:{\"click\":_vm.clearHandler}},[_vm._v(\"clear\")]),_vm._l((_vm.apiResponse),function(item){return _c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.geojsonString),expression:\"geojsonString\"}],attrs:{\"type\":\"radio\",\"name\":\"area\"},domProps:{\"value\":item.geojson,\"checked\":_vm._q(_vm.geojsonString,item.geojson)},on:{\"change\":function($event){_vm.geojsonString=item.geojson}}}),_vm._v(\" \"+_vm._s(item.area)+\" \")])}),_c('button',{on:{\"click\":_vm.highlightHandler}},[_vm._v(\"highlight\")])],2),_c('div',{staticStyle:{\"width\":\"100%\",\"height\":\"800px\"}},[_c('d3-geo-leaf-polygon',{attrs:{\"tile-provider\":\"Stamen.TonerLite\",\"geojson-object\":_vm.featureStatistics,\"color\":\"#FF6600\",\"auto-fit-bounds\":true,\"highlighted-meshes\":_vm.meshes},on:{\"dragend\":_vm.onDragEnd,\"zoomend\":_vm.onZoomEnd,\"initmap\":_vm.onInit}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default (obj, path) => {\n\n    var args = path.split('.'), i, l;\n\n    for (i=0, l=args.length; i<l; i++) {\n        if (!obj.hasOwnProperty(args[i]))\n            return;\n        obj = obj[args[i]];\n    }\n\n    return obj;\n}","<template>\n  <div>\n  </div>\n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport findprop from '../utils/findprop';\n\nconst props = {\n  // data: {\n  //   type: Array,\n  //   default: () => [],\n  // },\n  topojsonPath: {\n    type: String\n  },\n  width: {\n    type: [String, Number],\n    default: 1000\n  },\n  height: {\n    type: [String, Number],\n    default: 1000\n  },\n  colorRange: {\n    type: String,\n    default: '#0d47a1,#e3f2fd'\n  },\n  center: {\n    type: String,\n    default: '139.752268, 35.677043'\n  },\n  scale: {\n    type: [String, Number],\n    default: 110000\n  },\n  layerObjects: {\n    type: String,\n    default: 'districts'\n  },\n  layerFeatureName: {\n    type: String,\n    default: 'properties.district'\n  },\n  layerFeatureCode: {\n    type: String,\n    default: 'properties.district_code'\n  },\n  featureNameStyle: {\n    type: String,\n    default: 'static'\n  }\n};\n\nexport default {\n  name: 'd3-geo-staic',\n  // data() {\n  //   return {\n  //     data: [99, 71, 78, 25, 36, 92],\n  //     line: '',\n  //   };\n  // },\n  props,\n  mounted() {\n\n    const layerObjects = this.layerObjects;\n    const colorRange = this.colorRange;\n    const layerFeatureCode = this.layerFeatureCode;\n    const layerFeatureName = this.layerFeatureName;\n    const featureNameStyle = this.featureNameStyle;\n\n    const svg = d3.select(this.$el)\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height);\n\n    const g = svg.append('g');\n    const gLayer = g.append(\"g\").attr(\"id\", this.layerObjects);\n    const gLabelLayer = g.append(\"g\").attr(\"id\", this.layerObjects + \"_label\");\n\n    console.log(\"this.center:\", this.center);\n\n    const projection = d3.geoMercator()\n      .center(this.center.split(\",\"))\n      .scale(this.scale)\n      .translate([this.width / 2, this.height / 2]);\n\n    const path = d3.geoPath().projection(projection);\n    \n\n    \n    \n\n    // console.log(\"this.topojsonPath:\", this.topojsonPath);\n    ///////////////////////////////////////////////////////////////////////////\n    ////////////////////////// TODO:loading map data //////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    d3.json(this.topojsonPath).then(json => {\n      console.log(\"layerObjects:\", layerObjects);\n      const layerFeatues = topojson.feature(json, json.objects[layerObjects]).features;\n      const mesh = topojson.mesh(json, json.objects[layerObjects], function(a, b) { return a !== b; });\n\n      const color = d3.scaleLinear().domain([1,layerFeatues.length])\n                    .interpolate(d3.interpolateHcl)\n                    .range(colorRange.split(\",\"));\n\n      // fill color gradient process\n      const hgrads = g.append(\"defs\").attr(\"id\", layerObjects + \"_hdef\").selectAll(\"radialGradient\")\n        .data(layerFeatues)\n        .enter()\n        .append(\"radialGradient\")\n        .attr(\"gradientUnits\", \"objectBoundingBox\")\n        .attr(\"fx\", \"50%\")\n        .attr(\"fy\", \"50%\")\n        .attr(\"cx\", \"50%\")\n        .attr(\"cy\", \"50%\")\n        .attr(\"r\", \"100%\")\n        .attr(\"id\", function(d) { \n          // return \"hgrad\" + d.id;\n          return \"hgrad\" + findprop(d, layerFeatureCode);\n        });\n      \n      hgrads.append(\"stop\")\n          .attr(\"offset\", \"0%\")\n          .style(\"stop-color\", \"white\")\n          .style(\"stop-opacity\", \"1\");\n\n\n      hgrads.append(\"stop\")\n          .attr(\"offset\", \"100%\")\n          .style(\"stop-color\",  function(d, i) { \n            return color(i + 1); \n          })\n          .style(\"stop-opacity\", \"1\");\n\n      const grads = g.append(\"defs\").attr(\"id\", layerObjects + \"_def\").selectAll(\"radialGradient\")\n        .data(layerFeatues)\n        .enter()\n        .append(\"radialGradient\")\n        .attr(\"gradientUnits\", \"objectBoundingBox\")\n        .attr(\"fx\", \"50%\")\n        .attr(\"fy\", \"50%\")\n        .attr(\"cx\", \"50%\")\n        .attr(\"cy\", \"50%\")\n        .attr(\"r\", \"35%\")\n        .attr(\"id\", function(d) { \n          // return \"grad\" + d.id;\n          return \"grad\" + findprop(d, layerFeatureCode);\n        });\n\n      grads.append(\"stop\")\n          .attr(\"offset\", \"0%\")\n          .style(\"stop-color\",  function(d, i) { \n            return color(i + 1); \n          })\n          .style(\"stop-opacity\", \".8\");\n\n      grads.append(\"stop\")\n          .attr(\"offset\", \"100%\")\n          .style(\"stop-color\",  function(d, i) { \n            return color(i + 1); \n          })\n          .style(\"stop-opacity\", \"1\");\n\n      if (featureNameStyle == 'static') {\n        var mouseover = function(p) {\n\n          d3.select(this)\n            .style(\"fill\", function(d) {\n                // return \"url(#hgrad\" + d.id + \")\";\n                return \"url(#hgrad\" + findprop(d, layerFeatureCode) + \")\";\n            });\n\n        }\n        \n        var mouseout = function (p) {\n\n          d3.select(this)\n            .style(\"fill\", function(d) { \n              // return \"url(#grad\" + d.id + \")\";\n              return \"url(#grad\" + findprop(d, layerFeatureCode) + \")\";\n            });\n        }\n\n        // polygons\n        gLayer.selectAll(\"path\")\n          .data(layerFeatues)\n          .enter().append(\"path\")\n          // .attr(\"class\", \"layer1\")\n          .attr(\"d\", path)\n          // .attr(\"fill\", function(d,i) { \n          //   return color(i + 1);\n          // })\n          .attr(\"fill\", function(d) {\n              // return \"url(#grad\" + d.id + \")\";\n              return \"url(#grad\" + findprop(d, layerFeatureCode) + \")\";\n          })\n          .attr(\"layer-feature-code\", function(d) {\n            return findprop(d, layerFeatureCode);\n          })\n          .attr(\"layer-feature-name\", function(d) {\n            return findprop(d, layerFeatureName);\n          })\n          .on(\"mouseover\", mouseover)\n          .on(\"mouseout\", mouseout);\n\n        // border\n        gLayer.append(\"path\")\n          .datum(mesh)\n          .attr(\"d\", path)\n          .attr(\"class\", \"layer1-boundary\");\n\n        // Layer1 labels\n        gLabelLayer.selectAll(\"text\")\n          .data(layerFeatues)\n          .enter().append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"pointer-events\", \"none\")\n          .attr(\"transform\", function(d) { \n            return \"translate(\" + path.centroid(d) + \")\"; \n          })\n          .attr(\"dy\", \".35em\")\n          .text(function(d) { \n            return findprop(d, layerFeatureName); \n          })\n          .attr(\"layer-feature-code\", function(d) { \n            return findprop(d, layerFeatureCode);\n          });\n      } \n    });\n\n\n  }\n};\n</script>\n\n\n\n<style>\n@import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);\n\nsvg {\n  font-size: 11px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 300;\n  margin: auto;\n  display: block;\n}\n\n.background {\n  fill: none;\n  pointer-events: all;\n}\n\n.circle {\n}\n\n.layer1 {\n  cursor: pointer;\n}\n\n\n.layer1:hover {\n  fill: orange;\n}\n\n.layer1.active {\n  display:none;\n}\n\n.layer1-boundary {\n  fill: none;\n  stroke: white;\n  stroke-dasharray: 2,2;\n  stroke-linejoin: round;\n  stroke-width: 1;\n}\n\n.layer1LegendTitle {\n  fill: black;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n}\n\n.layer2 {\n  stroke: white;\n  stroke-width: 0.2;\n}\n\n.label {\n  fill: white;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n  text-shadow:\n    2px 2px 0 #000,\n    -1px -1px 0 #000,  \n    1px -1px 0 #000,\n    -1px 1px 0 #000,\n     1px 1px 0 #000;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoStatic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoStatic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./D3GeoStatic.vue?vue&type=template&id=5f182486&\"\nimport script from \"./D3GeoStatic.vue?vue&type=script&lang=js&\"\nexport * from \"./D3GeoStatic.vue?vue&type=script&lang=js&\"\nimport style0 from \"./D3GeoStatic.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n  </div>\n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport findprop from '../utils/findprop';\n\nconst props = {\n  id: {\n    type: String,\n    required: true\n  },\n  topojsonPath: {\n    type: String\n  },\n  width: {\n    type: [String, Number],\n    default: 1000\n  },\n  height: {\n    type: [String, Number],\n    default: 1000\n  },\n  colorRange: {\n    type: String,\n    default: '#e3f2fd,#2196f3,#0d47a1'\n  },\n  center: {\n    type: String,\n    default: '139.752268, 35.677043'\n  },\n  scale: {\n    type: [String, Number],\n    default: 110000\n  },\n  layer1Objects: {\n    type: String,\n    default: 'districts'\n  },\n  layer2Objects: {\n    type: String,\n    default: 'blocks'\n  },\n  layer1FeatureName: {\n    type: String,\n    default: 'properties.district'\n  },\n  layer1FeatureCode: {\n    type: String,\n    default: 'properties.district_code'\n  },\n  layer2FeatureName: {\n    type: String,\n    default: 'properties.block'\n  },\n  layer2FeatureCode: {\n    type: String,\n    default: 'properties.block_code'\n  },\n  layer1EventData: {\n    type: Object\n  },\n  layer2EventData: {\n    type: Array\n  },\n  layer1EventCountTag: {\n    type: String,\n    default: 'dropoffCount'\n  },\n  layer1LegendTitle: {\n    type: String,\n    default: 'Drop-off events in the last 30 minutes'\n  }\n};\n\nexport default {\n  name: 'd3-geo-double-layer',\n  data() {\n    return {\n      legendWidth: 0,\n      projection: {}\n    };\n  },\n  props,\n  mounted() {\n    let vm = this;\n\n    const svg = d3.select(this.$el)\n      .append('svg')\n      .attr('width', vm.width)\n      .attr('height', vm.height);\n\n    svg.append(\"rect\")\n      .attr(\"class\", \"background\")\n      .attr(\"width\", vm.width)\n      .attr(\"height\", vm.height)\n      .on(\"click\", reset);\n\n    const g = svg.append('g').attr(\"id\", \"base\");\n    const gLayer2 = g.append(\"g\").attr(\"id\", \"layer2\");\n    const gLayer1 = g.append(\"g\").attr(\"id\", \"layer1\");\n    const gLabelLayer2 = g.append(\"g\").attr(\"id\", \"layer2_label\");\n    const gLabelLayer1 = g.append(\"g\").attr(\"id\", \"layer1_label\");\n\n    this.projection = d3.geoMercator()\n      .center(vm.center.split(\",\"))\n      .scale(vm.scale)\n      .translate([vm.width / 2, vm.height / 2]);\n\n    const path = d3.geoPath().projection(this.projection);\n    \n\n    ///////////////////////////////////////////////////////////////////////////\n    ///////////////// adding common static gradients //////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    const commonGrads = g.append(\"defs\").attr(\"id\", \"common_grads_def\");\n\n    const circleGrads = commonGrads\n      .append(\"radialGradient\")\n      .attr(\"gradientUnits\", \"objectBoundingBox\")\n      .attr(\"fx\", \"50%\")\n      .attr(\"fy\", \"50%\")\n      .attr(\"cx\", \"50%\")\n      .attr(\"cy\", \"50%\")\n      .attr(\"r\", \"35%\")\n      .attr(\"id\", \"circleGrad1\");\n      \n    circleGrads.append(\"stop\")\n      .attr(\"offset\", \"0%\")\n      .style(\"stop-color\",  \"white\")\n      .style(\"stop-opacity\", \"1\");\n    \n    circleGrads.append(\"stop\")\n      .attr(\"offset\", \"100%\")\n      .style(\"stop-color\",  function(d) { \n        return \"orange\";\n      })\n      .style(\"stop-opacity\", \".6\");\n\n    ///////////////////////////////////////////////////////////////////////////\n    //////////////// Adding the initial gradient for the legend ///////////////\n    ///////////////////////////////////////////////////////////////////////////\n    const countPoints = vm.getCountPoints(1, vm.width, 10);\n    const countScale = vm.getCountScale(1, vm.width);\n\n    //Create the linearGradient\n    commonGrads\n      .append(\"linearGradient\")\n      .attr(\"id\", \"legend-traffic\")\n      .attr(\"x1\", \"0%\").attr(\"y1\", \"0%\")\n      .attr(\"x2\", \"100%\").attr(\"y2\", \"0%\")\n      .selectAll(\"stop\") \n      .data(d3.range(10))                \n      .enter().append(\"stop\") \n      .attr(\"offset\", function(d,i) { \n        return countScale( countPoints[i] ) / vm.width;\n      })   \n      .attr(\"stop-color\", function(d,i) { \n        return vm.colorRange.split(\",\")[0]; \n      });\n\n\n\n    ///////////////////////////////////////////////////////////////////////////\n    ////////////////////////// Draw the init legend ///////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n\n    const gBox = g.node().getBBox();\n\n    vm.legendWidth = Math.min(vm.width * 0.8, 600);\n    //Color Legend container\n    const legendsvg = g.append(\"g\")\n      .attr(\"id\", \"legendWrapper\")\n      .attr(\"transform\", \"translate(\" + (vm.width / 2) + \",\" + (vm.height * 0.95) + \")\");\n\n    //Draw the Rectangle\n    legendsvg.append(\"rect\")\n      .attr(\"id\", \"legendRect\")\n      .attr(\"x\", -vm.legendWidth/2)\n      .attr(\"y\", 0)\n      .attr(\"width\", vm.legendWidth)\n      .attr(\"height\", 10)\n      .style(\"fill\", \"url(#legend-traffic)\");\n      \n    //Append title\n    legendsvg.append(\"text\")\n      .attr(\"class\", \"layer1LegendTitle\")\n      .attr(\"x\", 0)\n      .attr(\"y\", -10)\n      .style(\"text-anchor\", \"middle\")\n      .text(vm.layer1LegendTitle);\n\n    //Define x-axis\n    const xAxis = vm.getXAxis(vm.legendWidth, 0);\n\n    //Set up X axis\n    legendsvg.append(\"g\")\n      .attr(\"id\", \"axis\")\n      .attr(\"transform\", \"translate(0,\" + (10) + \")\")\n      .call(xAxis);\n\n    // console.log(\"this.topojsonPath:\", this.topojsonPath);\n\n    d3.json(this.topojsonPath).then(json => {\n\n      const layer1Featues = topojson.feature(json, json.objects[vm.layer1Objects]).features;\n      const layer2Featues = topojson.feature(json, json.objects[vm.layer2Objects]).features;\n      const meshLayer1 = topojson.mesh(json, json.objects[vm.layer1Objects], function(a, b) { return a !== b; });\n\n      const initColor = vm.colorRange.split(\",\")[0];\n\n      // fill color gradient process\n      const hgrads = g.append(\"defs\").attr(\"id\", \"layer1_hgrads\").selectAll(\"radialGradient\")\n        .data(layer1Featues)\n        .enter()\n        .append(\"radialGradient\")\n        .attr(\"gradientUnits\", \"objectBoundingBox\")\n        .attr(\"fx\", \"50%\")\n        .attr(\"fy\", \"50%\")\n        .attr(\"cx\", \"50%\")\n        .attr(\"cy\", \"50%\")\n        .attr(\"r\", \"100%\")\n        .attr(\"id\", function(d, i) { \n          \n          return \"hgrad\" + findprop(d, vm.layer1FeatureCode);\n          // return \"hgrad\" + (i + 1);\n        });\n      \n      hgrads.append(\"stop\")\n          .attr(\"offset\", \"0%\")\n          .style(\"stop-color\", \"white\")\n          .style(\"stop-opacity\", \"1\");\n\n\n      hgrads.append(\"stop\")\n          .attr(\"offset\", \"100%\")\n          .style(\"stop-color\",  function(d, i) { \n            return initColor; \n          })\n          .style(\"stop-opacity\", \"1\");\n\n      const grads = g.append(\"defs\").attr(\"id\", \"layer1_grads\").selectAll(\"radialGradient\")\n        .data(layer1Featues)\n        .enter()\n        .append(\"radialGradient\")\n        .attr(\"gradientUnits\", \"objectBoundingBox\")\n        .attr(\"fx\", \"50%\")\n        .attr(\"fy\", \"50%\")\n        .attr(\"cx\", \"50%\")\n        .attr(\"cy\", \"50%\")\n        .attr(\"r\", \"35%\")\n        .attr(\"id\", function(d, i) { \n          return \"grad\" + findprop(d, vm.layer1FeatureCode);\n          // return \"grad\" + (i + 1);\n        });\n\n      grads.append(\"stop\")\n          .attr(\"offset\", \"0%\")\n          .style(\"stop-color\",  function(d, i) { \n            return initColor; \n          })\n          .style(\"stop-opacity\", \".7\");\n\n      grads.append(\"stop\")\n          .attr(\"offset\", \"100%\")\n          .style(\"stop-color\",  function(d, i) { \n            return initColor; \n          })\n          .style(\"stop-opacity\", \"1\");\n\n      const mouseoverLayer1 = function(p) {\n        console.log('mouseoverLayer1')\n        d3.select(this)\n          .style(\"fill\", function(d) {\n              return \"url(#hgrad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n          });\n      }\n      \n      const mouseoutLayer1 = function (p) {\n        d3.select(this)\n          .style(\"fill\", function(d) { \n            return \"url(#grad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n          });\n      }\n\n      // layer2 polygons and boundary\n      gLayer2.selectAll(\"path\")\n        .data(layer2Featues)\n        .enter().append(\"path\")\n        .attr(\"d\", path)\n        .attr(\"fill\", function(d, i) {\n            return \"url(#grad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n            // return \"#bbdefb\";\n        })\n        .style(\"fill-opacity\", 0)\n        .style(\"display\", \"none\")\n        .attr(\"layer1-feature-code\", function(d) {\n          return findprop(d, vm.layer1FeatureCode);\n        })\n        .attr(\"layer1-feature-name\", function(d) {\n          return findprop(d, vm.layer1FeatureName);\n        })\n        .attr(\"layer2-feature-code\", function(d) { \n          return findprop(d, vm.layer2FeatureCode);\n        })\n        .attr(\"layer2-feature-name\", function(d) { \n          return findprop(d, vm.layer2FeatureName);\n        })\n        .attr(\"class\", \"layer2\")\n        .on(\"click\", layer2Clicked)\n        .on(\"mouseover\", mouseoverLayer2)\n        .on(\"mouseout\", mouseoutLayer2);\n\n      // Layer2 labels\n      gLabelLayer2.selectAll(\"text\")\n        .data(layer2Featues)\n        .enter().append(\"text\")\n        .attr(\"class\", \"label\")\n        .style(\"fill-opacity\", 0)\n        .style(\"display\", \"none\")\n        .attr(\"transform\", function(d) { \n          return \"translate(\" + path.centroid(d) + \")\"; \n        })\n        .attr(\"dy\", \".35em\")\n        .attr(\"pointer-events\", \"none\")\n        .text(function(d) { \n          return findprop(d, vm.layer2FeatureName); \n        })\n        .attr(\"layer2-feature-code\", function(d) { \n          return findprop(d, vm.layer2FeatureCode);\n        });\n\n      // Layer1 polygons\n\n      gLayer1.selectAll(\"path\")\n        .data(layer1Featues)\n        .enter().append(\"path\")\n        .attr(\"class\", \"layer1\")\n        .attr(\"d\", path)\n        .style(\"fill\", function(d, i) {\n          return \"url(#grad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n        })\n        .attr(\"layer1-feature-code\", function(d) {\n          return findprop(d, vm.layer1FeatureCode);\n        })\n        .attr(\"layer1-feature-name\", function(d) {\n          return findprop(d, vm.layer1FeatureName);\n        })\n        .on(\"click\", layer1Clicked)\n        .on(\"mouseover\", mouseoverLayer1)\n        .on(\"mouseout\", mouseoutLayer1);\n\n      // Layer1 border\n      gLayer1.append(\"path\")\n        .datum(meshLayer1)\n        .attr(\"d\", path)\n        .attr(\"class\", \"layer1-boundary\");\n\n      // Layer1 labels\n      gLabelLayer1.selectAll(\"text\")\n        .data(layer1Featues)\n        .enter().append(\"text\")\n        .attr(\"class\", \"label\")\n        .attr(\"transform\", function(d) { \n          return \"translate(\" + path.centroid(d) + \")\"; \n        })\n        .attr(\"dy\", \".35em\")\n        .attr(\"pointer-events\", \"none\")\n        .text(function(d) { \n          return findprop(d, vm.layer1FeatureName); \n        })\n        .attr(\"layer1-feature-code\", function(d) { \n          return findprop(d, vm.layer1FeatureCode);\n        });\n\n    });\n\n    /***** click to zoom *****/\n    let active = d3.select(null);\n\n    const layer2Clicked = function(d) {\n      console.log(\"layer2Clicked\");\n      // console.log(\"active.node()\", active.node());\n      if (active.node()) {\n        if (this.getAttribute(\"layer1-feature-code\") == active.node().getAttribute(\"layer1-feature-code\")) {\n          return reset();\n        }\n      }\n    }\n\n    const layer1Clicked = function(d) {\n      console.log(\"layer1Clicked\");\n      // console.log(\"active.node()\", active.node());\n      // console.log(\"this\", this);\n      if (active.node() === this) {\n        return reset();\n      }\n\n      active.classed(\"active\", false);\n      active = d3.select(this).classed(\"active\", true);\n\n      zoom(d);\n    };\n\n\n    const zoom = function(d) {\n      const bounds = path.bounds(d),\n          dx = bounds[1][0] - bounds[0][0],\n          dy = bounds[1][1] - bounds[0][1],\n          x = (bounds[0][0] + bounds[1][0]) / 2,\n          y = (bounds[0][1] + bounds[1][1]) / 2,\n          scale = .9 / Math.max(dx / vm.width, dy / vm.height),\n          translate = [vm.width / 2 - scale * x, vm.height / 2 - scale * y];\n\n      g.transition()\n        .duration(750)\n        .style(\"stroke-width\", 1.5 / scale + \"px\")\n        .attr(\"transform\", \"translate(\" + translate + \")scale(\" + scale + \")\");\n\n      // hide layer1 labels\n      gLabelLayer1.selectAll('text')\n        .transition()\n        .style(\"fill-opacity\", 0)\n        .transition()\n        .style(\"display\", \"none\");\n\n\n      gLayer2.selectAll(\"path\")\n        .transition()\n        .style(\"fill-opacity\", 1)\n        .style(\"display\", \"block\");\n\n\n      // callback to notify the specified feature is ready to receive location events\n      const featureCode = findprop(d, vm.layer1FeatureCode);\n      // console.log(\"featureCode\", featureCode);\n      vm.$emit('on-stop-events');\n      vm.$emit('on-receive-events', featureCode);\n    }\n\n    function reset() {\n      // console.log(\"reset\");\n      active.classed(\"active\", false);\n      active = d3.select(null);\n\n      g.transition()\n        .duration(750)\n        .style(\"stroke-width\", \"1.5px\")\n        .attr(\"transform\", \"\");\n\n      // show layer1 labels\n      gLabelLayer1.selectAll('text')\n        .transition()\n        .style(\"display\", \"block\")\n        .transition()\n        .duration(250)\n        .style(\"fill-opacity\", 1);\n\n      gLayer2.selectAll(\"path\")\n        .transition()\n        .style(\"fill-opacity\", 0)\n        .style(\"display\", \"none\");\n\n      // scope.onStopEvents();\n      vm.$emit('on-stop-events');\n    };\n    /***** click to zoom *****/\n\n    ///////////////////////////////////////////////////////////////////////////\n    /////////////////////// Mouse over Layer2 Process /////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    const mouseoverLayer2 = function(p) {\n      console.log('mouseoverLayer2')\n      gLabelLayer2.selectAll(\"text\")\n        .filter(function(d){\n          console.log(\"p\", findprop(p, vm.layer2FeatureCode))\n          console.log(\"d\", findprop(d, vm.layer2FeatureCode))\n          return findprop(p, vm.layer2FeatureCode) == findprop(d, vm.layer2FeatureCode);\n        })\n        .transition()\n        .style(\"fill-opacity\", 1)\n        .style(\"display\", \"block\");\n\n      d3.select(this)\n        .style(\"fill\", function(d) {\n            return \"url(#hgrad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n        });\n    }\n\n    ///////////////////////////////////////////////////////////////////////////\n    /////////////////////// Mouse out Layer2 Process /////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    const mouseoutLayer2 = function (p) {\n      gLabelLayer2.selectAll(\"text\")\n        .filter(function(d){\n          return findprop(p, vm.layer2FeatureCode) == findprop(d, vm.layer2FeatureCode);\n        })\n        .transition()\n        .style(\"fill-opacity\", 0)\n        .transition()\n        .style(\"display\", \"none\");\n\n      d3.select(this)\n        .style(\"fill\", function(d) {\n            return \"url(#grad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n        });\n    }\n\n  },\n  watch: {\n    layer1EventData: function(newData, oldData) {\n      this.visualizeLayer1Events(newData);\n    },\n    layer2EventData: function(newData, oldData) {\n      this.visualizeLayer2Events(newData);\n    }\n  },\n  methods: {\n    ///////////////////////////////////////////////////////////////////////////\n    ///////// Set the style of the legned and map objects on Layer1 ///////////\n    ///////////////////////////////////////////////////////////////////////////\n    visualizeLayer1Events(eventList) {\n      let vm = this;\n\n      const events = d3.entries(eventList);\n\n      const maxCount = d3.max(events, function(d) {\n        return d.value[vm.layer1EventCountTag]; \n      });\n\n      ///////////////////////////////////////////////////////////////////////////\n      //////////////// Update the gradient for the legend ///////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const colorScale = vm.getColorScale(maxCount, vm.colorRange);\n\n      const countPoints = vm.getCountPoints(maxCount, vm.width, 10);\n\n      //Update the linearGradient\n      d3.select(\"#common_grads_def\")\n        .selectAll(\"linearGradient\")\n        .selectAll(\"stop\")\n        .attr(\"stop-color\",  function(d, i) { \n          return colorScale(countPoints[i]); \n        });\n\n      ///////////////////////////////////////////////////////////////////////////\n      ////////////////////////// Update the legend //////////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const xAxis = vm.getXAxis(vm.legendWidth, maxCount);\n\n      d3.select(\"#axis\")\n        .selectAll(\".tick\")\n        .remove();\n\n      d3.select(\"#axis\")\n        .call(xAxis);\n\n\n      ///////////////////////////////////////////////////////////////////////////\n      //////////////// Set the dynamic gradient for layer1 //////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      // const gLayer1 = d3.selectAll(\"#layer1\");\n\n      // edit event count  \n      d3.select(\"#layer1\").selectAll(\"path\")\n        .filter(function(d){\n          if (d.type === \"Feature\") {\n            const featureCode = findprop(d, vm.layer1FeatureCode);\n            const element = eventList[featureCode];\n            \n            if (!element) {\n              d[vm.layer1EventCountTag] = 1;\n              return true;\n            } \n            else {\n              const sortValue = element[vm.layer1EventCountTag];\n              if (d[vm.layer1EventCountTag]) {\n                if (sortValue != d[vm.layer1EventCountTag]) {\n                  d[vm.layer1EventCountTag] = sortValue;\n                  return true;\n                }\n              } \n              else {\n                d[vm.layer1EventCountTag] = sortValue;\n                return true;\n              }                    \n            }\n          }\n          return false;\n        });\n\n      // edit event count\n      d3.select(\"#layer1_grads\")\n        .selectAll(\"radialGradient\")\n        .selectAll(\"stop\")\n        .style(\"stop-color\",  function(d, i) { \n          return colorScale(d[vm.layer1EventCountTag]); \n        });\n\n      d3.select(\"#layer1_hgrads\")\n        .selectAll(\"radialGradient\")\n        .selectAll(\"stop\")\n        .filter(function(d){\n            return this.getAttribute(\"offset\") === \"100%\"\n        })\n        .style(\"stop-color\",  function(d, i) { \n          return colorScale(d[vm.layer1EventCountTag]); \n        });\n\n      d3.select(\"#layer1\").selectAll(\"path\")\n        .filter(function(d){\n          return d.type === \"Feature\"\n        })\n        .style(\"fill\", function(d, i) {\n          return \"url(#grad\" + findprop(d, vm.layer1FeatureCode) + \")\";\n        });\n    },\n    ///////////////////////////////////////////////////////////////////////////\n    ///////// Set the style of the legned and map objects on Layer2 ///////////\n    ///////////////////////////////////////////////////////////////////////////\n    visualizeLayer2Events(data) {\n      console.log(data);\n      let vm = this;\n\n      d3.select(\"#base\").selectAll('circle')\n        .data(data)\n        .enter().append('circle')\n        .style('opacity', 0)\n        .attr(\"class\", \"circle\")\n        .style(\"fill\", function(d, i) {\n          return \"url(#circleGrad1)\";\n        })\n        .attr('cx', function(d) { \n          return vm.projection(d)[0];\n        })\n        .attr('cy', function(d) { \n          return vm.projection(d)[1];\n        })\n        .attr('r', 2)\n      .transition()\n        .delay(function(d,i) { return i * 100; })\n        .style('opacity', 1)\n      .transition()\n        .delay(function(d,i) { return i * 100 + 250 + 100; })\n        .style('opacity', 0)\n        .remove();\n    },\n    ///////////////////////////////////////////////////////////////////////////\n    /////////////////////// legend common functions ///////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    getCountScale(maxCount, width) {\n      //Calculate the variables for the sort gradient\n      return d3.scaleLinear()\n        .domain([0, maxCount])\n        .range([0, width]);\n    },\n    getCountPoints(maxCount, width, size) {\n      //Calculate the variables for the sort gradient\n      const countScale = this.getCountScale(maxCount, size);\n\n      //Calculate the variables for the sort gradient\n      const countRange = countScale.domain();\n      countRange[2] = countRange[1] - countRange[0];\n      const countPoints = [];\n      for(let i = 0; i < size; i++) {\n        countPoints.push(i * countRange[2]/(size-1) + countRange[0]);\n      }\n\n      return countPoints;\n    },\n    getColorScale(maxCount, colorRange) {\n\n      return d3.scaleLinear()\n        .domain([0, maxCount/2, maxCount])\n        .range(colorRange.split(\",\"));\n    },\n    getXAxis(legendWidth, maxCount) {\n      const xScale = d3.scaleLinear()\n       .range([-legendWidth/2, legendWidth/2])\n       .domain([ 0, maxCount] );\n\n      return d3.axisBottom()\n              .ticks(5)\n              //.tickFormat(formatPercent)\n              .scale(xScale);\n    }\n  }\n\n};\n</script>\n\n<style>\n@import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);\n\nsvg {\n  font-size: 11px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 300;\n  margin: auto;\n  display: block;\n}\n\n.background {\n  fill: none;\n  pointer-events: all;\n}\n\n.circle {\n}\n\n.layer1 {\n  cursor: pointer;\n}\n\n\n.layer1:hover {\n  fill: orange;\n}\n\n.layer1.active {\n  display:none;\n}\n\n.layer1-boundary {\n  fill: none;\n  stroke: white;\n  stroke-dasharray: 2,2;\n  stroke-linejoin: round;\n  stroke-width: 1;\n}\n\n.layer1LegendTitle {\n  fill: black;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n}\n\n.layer2 {\n  stroke: white;\n  stroke-width: 0.2;\n}\n\n.label {\n  fill: white;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n  text-shadow:\n    2px 2px 0 #000,\n    -1px -1px 0 #000,  \n    1px -1px 0 #000,\n    -1px 1px 0 #000,\n     1px 1px 0 #000;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoDoubleLayer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoDoubleLayer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./D3GeoDoubleLayer.vue?vue&type=template&id=c52e47e2&\"\nimport script from \"./D3GeoDoubleLayer.vue?vue&type=script&lang=js&\"\nexport * from \"./D3GeoDoubleLayer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./D3GeoDoubleLayer.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n  </div>\n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport findprop from '../utils/findprop';\n\nconst props = {\n  id: {\n    type: String,\n    required: true\n  },\n  topojsonPath: {\n    type: String\n  },\n  width: {\n    type: [String, Number],\n    default: 1000\n  },\n  height: {\n    type: [String, Number],\n    default: 1000\n  },\n  bgColor: {\n    type: String,\n    default: '#bbdefb'\n  },\n  colorRange: {\n    type: String,\n    default: '#227AFF,#FFF500'\n  },\n  topNumber: {\n    type: [String, Number],\n    default: 10\n  },\n  center: {\n    type: String,\n    default: '139.752268, 35.677043'\n  },\n  scale: {\n    type: [String, Number],\n    default: 150000\n  },\n  layerObjects: {\n    type: String,\n    default: 'blocks'\n  },\n  layerFeatureName: {\n    type: String,\n    default: 'properties.block'\n  },\n  layerFeatureCode: {\n    type: String,\n    default: 'properties.block_code'\n  },\n  layerEventData: {\n    type: Array\n  }\n};\n\nexport default {\n  name: 'd3-geo-events',\n  data() {\n    return {\n      // legendWidth: 0,\n      projection: {}\n    };\n  },\n  props,\n  mounted() {\n    let vm = this;\n\n    const svg = d3.select(this.$el)\n      .append('svg')\n      .attr('width', vm.width)\n      .attr('height', vm.height);\n\n    const g = svg.append('g').attr(\"id\", \"base\");\n    const gLayer = g.append(\"g\").attr(\"id\", vm.layerObjects);\n    const gLabelLayer = g.append(\"g\").attr(\"id\", vm.layerObjects + \"_label\");\n\n    this.projection = d3.geoMercator()\n      .center(vm.center.split(\",\"))\n      .scale(vm.scale)\n      .translate([vm.width / 2, vm.height / 2]);\n\n    const path = d3.geoPath().projection(this.projection);\n    \n    const colorScale = vm.getColorScale(vm.topNumber, vm.colorRange);\n\n    ///////////////////////////////////////////////////////////////////////////\n    ////////////////// adding from/to gradients ///////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    const fromGrads = g.append(\"defs\").attr(\"id\", \"from_def\")\n      .selectAll(\"linearGradient\")\n      .data(d3.range(1, parseInt(vm.topNumber) + 1))\n      .enter()\n      .append(\"linearGradient\")\n      .attr(\"gradientUnits\", \"objectBoundingBox\")\n      .attr(\"x1\", \"100%\")\n      .attr(\"y1\", \"0%\")\n      .attr(\"x2\", \"0%\")\n      .attr(\"y2\", \"0%\")\n      .attr(\"id\", function(d, i) { \n        return \"fromGrad\" + (i + 1);\n      });\n\n    fromGrads.append(\"stop\")\n        .attr(\"offset\", \"0%\")\n        .style(\"stop-color\", \"white\")\n        .style(\"stop-opacity\", \"1\");\n\n    fromGrads.append(\"stop\")\n        .attr(\"offset\", \"100%\")\n        .style(\"stop-color\",  function(d, i) { \n          return colorScale(i + 1); \n        })\n        .style(\"stop-opacity\", \"1\");\n\n\n    // fill color gradient process\n    var toGrads = g.append(\"defs\").attr(\"id\", \"to_def\")\n      .selectAll(\"linearGradient\")\n      .data(d3.range(1, parseInt(vm.topNumber) + 1))\n      .enter()\n      .append(\"linearGradient\")\n      .attr(\"gradientUnits\", \"objectBoundingBox\")\n      .attr(\"x1\", \"0%\")\n      .attr(\"y1\", \"0%\")\n      .attr(\"x2\", \"100%\")\n      .attr(\"y2\", \"0%\")\n      .attr(\"id\", function(d, i) { \n        return \"toGrad\" + (i + 1);\n      });\n    \n    toGrads.append(\"stop\")\n        .attr(\"offset\", \"0%\")\n        .style(\"stop-color\", \"white\")\n        .style(\"stop-opacity\", \"1\");\n\n\n    toGrads.append(\"stop\")\n        .attr(\"offset\", \"100%\")\n        .style(\"stop-color\",  function(d, i) { \n          return colorScale(i + 1); \n        })\n        .style(\"stop-opacity\", \"1\");\n\n    ///////////////////////////////////////////////////////////////////////////\n    ////////////////////////// TODO:loading map data //////////////////////////\n    ///////////////////////////////////////////////////////////////////////////\n    d3.json(this.topojsonPath).then(json => {\n      const layerFeatues = topojson.feature(json, json.objects[vm.layerObjects]).features;\n      const mesh = topojson.mesh(json, json.objects[vm.layerObjects], function(a, b) { return a !== b; });\n\n      // polygons\n      gLayer.selectAll(\"path\")\n        .data(layerFeatues)\n        .enter().append(\"path\")\n        .attr(\"d\", path)\n        .attr(\"fill\", vm.bgColor)\n        .attr(\"layer-feature-code\", function(d) {\n          return findprop(d, vm.layerFeatureCode);\n        });\n\n      // border\n      gLayer.append(\"path\")\n        .datum(mesh)\n        .attr(\"d\", path)\n        .attr(\"class\", \"layer1-boundary\");\n\n      // Layer1 labels\n      gLabelLayer.selectAll(\"text\")\n        .data(layerFeatues)\n        .enter()\n        .append(\"text\")\n        .attr(\"class\", \"label\")\n        .attr(\"transform\", function(d) { \n          return \"translate(\" + path.centroid(d) + \")\"; \n        })\n        .attr(\"dy\", \"-1em\");\n    });\n\n\n  },\n  watch: {\n    layerEventData: function(newData, oldData) {\n      this.hideFeatureNames().then(() => {\n          if (newData) {\n            this.showFeatureNames(newData);  \n          }\n        });\n\n      this.dehighlightFeatures().then(() => {\n          if (newData) {\n            this.highlightFeatures(newData);  \n          }\n        });\n    }\n  },\n  methods: {\n    ///////////////////////////////////////////////////////////////////////////\n    ///////// Set the style of the legned and map objects on Layer1 ///////////\n    ///////////////////////////////////////////////////////////////////////////\n    hideFeatureNames() {\n      let vm = this;\n\n      const gLabelLayer = d3.select(\"#\" + vm.layerObjects + \"_label\");\n\n      return new Promise((resolve, reject) => {\n        const highlightData = gLabelLayer.selectAll(\"text\")\n          .filter(function(d){\n            return d.hasOwnProperty(\"showname\");\n          });\n\n        if (highlightData.size() == 0) {\n          resolve();\n        } else {\n          let n = 0;\n\n          highlightData\n            .transition()\n            .style(\"fill-opacity\", 0)\n            .transition()\n            .text(function(d){\n              if (d.hasOwnProperty(\"showname\")) {\n                delete d.showname;\n              }\n              return \"\";\n            })\n            .attr(\"style\", null)\n            .each(function() {\n              ++n; \n            })\n            .on(\"end\", () => { \n              if (!--n) {\n                resolve();\n              }; \n            });\n        }\n      });\n    },\n/*\n    hideFeatureNames() {\n      let vm = this;\n\n      const gLabelLayer = d3.select(\"#\" + vm.layerObjects + \"_label\");\n\n      return new Promise((resolve, reject) => {\n        const highlightData = gLabelLayer.selectAll(\"text\")\n          .filter(function(d){\n            return d.hasOwnProperty(\"showname\");\n          });\n\n        if (highlightData.size() == 0) {\n          resolve();\n        } else {\n          highlightData\n            .transition()\n            .style(\"fill-opacity\", 0)\n            .transition()\n            .text(function(d){\n              if (d.hasOwnProperty(\"showname\")) {\n                delete d.showname;\n              }\n              return \"\";\n            })\n            .attr(\"style\", null)\n            .call(vm.endall, function() {\n              resolve();\n            });\n        }\n      });\n    },\n*/\n    showFeatureNames(newValue) {\n      let vm = this;\n\n      const gLabelLayer = d3.select(\"#\" + vm.layerObjects + \"_label\");\n\n      const fromFeatureCodes = this.extractCodes(newValue, \"from_code\");\n      const toFeatureCodes = this.extractCodes(newValue, \"to_code\");\n\n      gLabelLayer.selectAll(\"text\")\n        .filter(function(d){\n          return (fromFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode)) > -1)\n            || (toFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode)) > -1);\n        })\n        .text(function(d){\n          const fromIndex = fromFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          const toIndex = toFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          if (fromIndex > -1) {\n            return (fromIndex + 1) + \"_\" + findprop(d, vm.layerFeatureName);\n          }\n          else if (toIndex > -1) {\n            return (toIndex + 1) + \"_\" + findprop(d, vm.layerFeatureName);\n          }\n        })\n        .transition()\n        .style(\"fill-opacity\", 1)\n        .style(\"display\", \"block\")\n        .style(\"fill\", function(d,i) {\n          d.showname = true;\n\n          const fromIndex = fromFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          const toIndex = toFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          if (fromIndex > -1) {\n            // return color(fromIndex + 1);\n            return \"url(#fromGrad\" + (fromIndex + 1) + \")\";\n          }\n          else if (toIndex > -1) {\n            return \"url(#toGrad\" + (toIndex + 1) + \")\";\n          }\n        });\n    },\n    dehighlightFeatures(oldFeatureCodes) {\n\n      let vm = this;\n\n      const gLayer = d3.select(\"#\" + vm.layerObjects);\n\n      return new Promise((resolve, reject) => {\n        const highlightData = gLayer.selectAll(\"path\")\n          .filter(function(d){\n            return d.hasOwnProperty(\"highlight\");\n          });\n\n        if (highlightData.size() == 0) {\n          resolve();\n        } else {\n          let n = 0;\n\n          highlightData\n            .transition()\n            .attr(\"fill\", function(d){\n              delete d.highlight;\n              return vm.bgColor;\n            })\n            .each(function() {\n              ++n; \n            })\n            .on(\"end\", () => { \n              if (!--n) {\n                resolve();\n              }; \n            });            \n               \n        }\n      });\n    },    \n/*    \n    dehighlightFeatures(oldFeatureCodes) {\n\n      let vm = this;\n\n      const gLayer = d3.select(\"#\" + vm.layerObjects);\n\n      return new Promise((resolve, reject) => {\n        const highlightData = gLayer.selectAll(\"path\")\n          .filter(function(d){\n            return d.hasOwnProperty(\"highlight\");\n          });\n\n        if (highlightData.size() == 0) {\n          resolve();\n        } else {\n          highlightData\n            .transition()\n            .attr(\"fill\", function(d){\n              delete d.highlight;\n              return vm.bgColor;\n            })\n            .call(vm.endall, function() {\n              resolve();\n            });                \n        }\n      });\n    },\n*/    \n    highlightFeatures(newValue) {\n\n      // var color = d3.scaleLinear().domain([1, newValue.length])\n      //               .interpolate(d3.interpolateHcl)\n      //               .range(scope.colorRange.split(\",\"));\n\n      let vm = this;\n\n      const fromFeatureCodes = vm.extractCodes(newValue, \"from_code\");\n      const toFeatureCodes = vm.extractCodes(newValue, \"to_code\");\n\n      const colorScale = vm.getColorScale(vm.topNumber, vm.colorRange);\n\n      const gLayer = d3.select(\"#\" + vm.layerObjects);\n\n      gLayer.selectAll(\"path\")\n        .filter(function(d){\n          return (fromFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode)) > -1)\n            || (toFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode)) > -1);\n        })\n        .transition()\n        .attr(\"fill\", function(d,i) {\n          d.highlight = true;\n\n          const fromIndex = fromFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          const toIndex = toFeatureCodes.indexOf(findprop(d, vm.layerFeatureCode));\n          if (fromIndex > -1) {\n            return colorScale(fromIndex + 1);\n            // return \"url(#fromGrad\" + (fromIndex + 1) + \")\";\n          }\n          else if (toIndex > -1) {\n            return colorScale(toIndex + 1);\n            // return \"url(#toGrad\" + (toIndex + 1) + \")\";\n          }\n        });\n    },\n/*    \n    endall(transition, callback) { \n      let n = 0; \n      transition \n        .each(function() { ++n; }) \n        .on(\"end\", () => { \n          if (!--n) callback.apply(this, arguments); \n        }); \n    },\n*/    \n    extractCodes(routes, key) {\n      let featureCodes = [];\n      if (routes) {\n        \n        routes.forEach(function(entry) {\n            featureCodes.push(entry[key]);\n        });\n\n        return featureCodes;\n      }\n      else {\n        return featureCodes;\n      }\n    },\n    getColorScale(topNumber, colorRange) { \n      return d3.scaleLinear().domain([1, topNumber])\n        .interpolate(d3.interpolateHcl)\n        .range(colorRange.split(\",\"));\n    }\n  }\n\n};\n</script>\n\n<style>\n@import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);\n\nsvg {\n  font-size: 11px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 300;\n  margin: auto;\n  display: block;\n}\n\n.background {\n  fill: none;\n  pointer-events: all;\n}\n\n.circle {\n}\n\n.layer1 {\n  cursor: pointer;\n}\n\n\n.layer1:hover {\n  fill: orange;\n}\n\n.layer1.active {\n  display:none;\n}\n\n.layer1-boundary {\n  fill: none;\n  stroke: white;\n  stroke-dasharray: 2,2;\n  stroke-linejoin: round;\n  stroke-width: 1;\n}\n\n.layer1LegendTitle {\n  fill: black;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n}\n\n.layer2 {\n  stroke: white;\n  stroke-width: 0.2;\n}\n\n.label {\n  fill: white;\n  fill-opacity: 1;\n  font-size: 18px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n  text-shadow:\n    2px 2px 0 #000,\n    -1px -1px 0 #000,  \n    1px -1px 0 #000,\n    -1px 1px 0 #000,\n     1px 1px 0 #000;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoEvents.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoEvents.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./D3GeoEvents.vue?vue&type=template&id=2ae661a6&\"\nimport script from \"./D3GeoEvents.vue?vue&type=script&lang=js&\"\nexport * from \"./D3GeoEvents.vue?vue&type=script&lang=js&\"\nimport style0 from \"./D3GeoEvents.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"leaflet\",style:({ height: '100%', width:'100%'}),attrs:{\"id\":\"leaflet\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"leaflet\" ref=\"leaflet\" :style=\"{ height: '100%', width:'100%'}\"></div>\n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport findprop from '../utils/findprop';\n\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport 'leaflet-providers/leaflet-providers.js';\n\nconst props = {\n  tileProvider: {\n    type: String,\n    default: 'CartoDB.Voyager'\n  },  \n  geojsonPath: {\n    type: String\n  },\n  geojsonObject: {\n    type: Object\n  },\n  legendWidth: {\n    type: [String, Number],\n    default: 500\n  },\n  colorRange: {\n    type: String,\n    default: '#0000ff,#e623e4,#ff0000'\n  },\n  mapCenter: {\n    type: String,\n    default: '139.77887823700362, 35.69026554219554'\n  },\n  mapZoom: {\n    type: [String, Number],\n    default: 17\n  },  \n  legendCenter: {\n    type: String,\n    default: '400, 50'\n  },  \n  geojsonType: {\n    type: String,\n    default: 'lines'\n  },\n  countTag: {\n    type: String,\n    default: 'collected'\n  },\n  idTag: {\n    type: String,\n    default: 'id'\n  },\n  legendTitle: {\n    type: String,\n    default: 'Collected Count Per Feature'\n  },\n  autoFitBounds: {\n    type: Boolean,\n    default: false\n  }\n};\nexport default {\n  name: 'd3-geo-leaf',\n  data() {\n    return {\n      map: null,\n      svg: null,\n      mapAdded: false,\n      svgAdded: false,\n    };\n  },\n  props,\n  computed: {  \n    legendCenterObj: function() {\n      return { x: parseInt(this.legendCenter.split(\",\")[0]), y: parseInt(this.legendCenter.split(\",\")[1]) }\n    }    \n  },   \n  watch: {\n    geojsonObject: {\n        handler: function(newVal, oldVal){\n          if (newVal)   {\n            this.renderMap();  \n          } else {\n            this.clearSvg();\n          }\n          \n        },\n        deep: true\n\n    }\n  },\n  mounted () {\n    this.renderMap();\n  },\n  methods: {\n    clearSvg() {\n      const vm = this;\n\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\");\n\n      g.selectAll(`g[id=${this.geojsonType}]`).remove();\n\n      g.selectAll(`g[id=${this.geojsonType}_label]`).remove();\n\n      g.selectAll(\"defs[id=color_grads_def]\").remove();\n\n      g.selectAll(\"g[id=legend_wrapper]\").remove();\n\n    },\n    renderMap() {\n      const vm = this;\n\n      // let map;\n\n      // fit bounds based on the geojsonObject\n      if (!this.mapAdded) {\n        if (this.geojsonObject) {\n          vm.map = L.map(this.$refs['leaflet']).fitBounds(L.geoJson(this.geojsonObject).getBounds());\n\n        } else {\n          vm.map = L.map(this.$refs['leaflet']);\n          vm.map.setView(new L.LatLng(this.mapCenter.split(\",\")[1], this.mapCenter.split(\",\")[0]), this.mapZoom);\n        }\n\n        this.mapAdded = true;\n\n        L.tileLayer.provider(vm.tileProvider).addTo(vm.map);\n\n        vm.map.on(\"zoomend\", () => {\n          this.$emit('zoomend', vm.getBounds(vm.map));\n        });\n\n        vm.map.on(\"dragend\", () => {\n          this.$emit('dragend', vm.getBounds(vm.map));\n        });      \n\n        this.$emit('initmap', vm.getBounds(vm.map));        \n      } else {\n        if (this.autoFitBounds) {\n          vm.map.fitBounds(L.geoJson(this.geojsonObject).getBounds());\n        }\n      }\n\n\n      \n      // L.tileLayer.provider('CartoDB.PositronNoLabels').addTo(map);\n      // L.tileLayer.provider('CartoDB.VoyagerNoLabels').addTo(map);\n      // L.tileLayer.provider('Stamen.TonerBackground').addTo(map);\n      // L.tileLayer.provider('Stamen.TonerLite').addTo(map);\n      // L.tileLayer.provider('Hydda.Base').addTo(map);\n      \n      if (!this.geojsonObject) {\n        return;\n      }\n\n\n      ///////////////////////////////////////////////////////////////////////////\n      /////////////////////////// Get Scale Functions ///////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const events = d3.entries(this.geojsonObject.features);\n\n      const maxCount = d3.max(events, function(d) {\n        return d.value.properties[vm.countTag]; \n      });\n\n      const colorDense = 10;\n      const countPoints = this.getCountPoints(maxCount, this.legendWidth, colorDense);\n      const countScale = this.getCountScale(maxCount, this.legendWidth);\n      const colorScale = this.getColorScale(maxCount, this.colorRange);  \n\n      ///////////////////////////////////////////////////////////////////////////\n      ///////////////////// create transform and path function //////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const transform = d3.geoTransform({\n        point: function(x, y) {\n          const point = vm.map.latLngToLayerPoint(new L.LatLng(y, x));\n          this.stream.point(point.x, point.y);\n        }\n      });\n\n      const path = d3.geoPath().projection(transform);\n\n      ///////////////////////////////////////////////////////////////////////////\n      ///////////////////////////////// add svg /////////////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      if (!this.svgAdded) {\n        L.svg().addTo(vm.map); \n\n        this.svgAdded = true;\n      }\n      \n      ///////////////////////////////////////////////////////////////////////////\n      /////////////////////////// add geojson and label /////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\");\n\n      g.selectAll(`g[id=${this.geojsonType}]`).remove();\n      const gGeojsonLayer = g.append(\"g\").attr(\"id\", this.geojsonType);\n\n      g.selectAll(`g[id=${this.geojsonType}_label]`).remove();\n      const gLabelLayer = g.append(\"g\").attr(\"id\", this.geojsonType + \"_label\");\n\n\n      const mouseover = function(p, i) {\n        d3.select(this)\n          .style(\"cursor\", \"pointer\")\n          .style(\"stroke-width\", \"5px\")\n\n        gLabelLayer.selectAll(\"text\")\n          .filter(function(d){\n            return d.properties[vm.idTag] == p.properties[vm.idTag];\n          })\n          .transition()\n          .style(\"fill-opacity\", 1)\n          .style(\"display\", \"block\")\n          .attr(\"fill\", function(d,i) {\n            return colorScale(p.properties[vm.countTag]);\n          });\n      }\n\n      const mouseout = function(p, i) {\n        d3.select(this)\n          .style(\"cursor\", \"\")\n          .style(\"stroke-width\", \"3px\");\n\n        gLabelLayer.selectAll(\"text\")\n          .filter(function(d){\n            return d.properties[vm.idTag] == p.properties[vm.idTag];\n          })\n          .transition()\n          .style(\"fill-opacity\", 0)\n          .transition()\n          .style(\"display\", \"none\");        \n      }      \n\n      gGeojsonLayer.selectAll(\"path\")\n        .data(this.geojsonObject.features)\n        .enter()\n        .append(\"path\")\n        .style(\"fill\", \"none\")        \n        .style(\"stroke-width\", \"3px\")\n        .style(\"pointer-events\", \"auto\")\n        .attr(\"stroke\", function(d,i) {\n          return colorScale(d.properties[vm.countTag]);\n        })\n        .on(\"mouseout\", mouseout)\n        .on(\"mouseover\", mouseover);\n\n      // Subway labels\n      gLabelLayer.selectAll(\"text\")\n        .data(this.geojsonObject.features)\n        .enter()\n        .append(\"text\")\n        .attr(\"class\", \"geojsonLabel\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"transform\", function(d) { \n          return \"translate(\" + path.centroid(d) + \")\"; \n        })\n        .attr(\"dy\", \".35em\")\n        .text(function(d) { \n          return d.properties[vm.countTag];\n        });\n\n      ///////////////////////////////////////////////////////////////////////////\n      ///////////////// Adding the initial gradient for the legend //////////////\n      ///////////////////////////////////////////////////////////////////////////\n      g.selectAll(\"defs[id=color_grads_def]\").remove();\n\n      const commonGrads = g.append(\"defs\")      \n        .attr(\"id\", \"color_grads_def\");\n\n      commonGrads\n        .append(\"linearGradient\")\n        .attr(\"id\", \"legendTraffic\")\n        .attr(\"x1\", \"0%\").attr(\"y1\", \"0%\")\n        .attr(\"x2\", \"100%\").attr(\"y2\", \"0%\")\n        .selectAll(\"stop\") \n        .data(d3.range(colorDense))                \n        .enter().append(\"stop\") \n        .attr(\"offset\", function(d,i) { \n          return countScale( countPoints[i] ) / vm.legendWidth;\n        })   \n        .attr(\"stop-color\", function(d,i) { \n          return colorScale(countPoints[i]);  \n        });      \n\n\n      ///////////////////////////////////////////////////////////////////////////\n      ////////////////////////// Draw the init legend ///////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      // vm.legendWidth = Math.min(vm.width * 0.8, 600);\n\n      // Color Legend container\n      g.selectAll(\"g[id=legend_wrapper]\").remove();\n\n      const legendsvg = g.append(\"g\")      \n        .attr(\"id\", \"legend_wrapper\")\n        // .attr(\"transform\", \"translate(\" + (vm.width / 2) + \",\" + (vm.height * 0.95) + \")\");\n        .attr(\"transform\", \"translate(\" + vm.legendCenterObj.x + \",\" + vm.legendCenterObj.y + \")\");\n\n      //Draw the Rectangle\n      legendsvg.append(\"rect\")\n        .attr(\"id\", \"legend_rect\")\n        .attr(\"x\", -vm.legendWidth/2)\n        .attr(\"y\", 0)\n        .attr(\"width\", vm.legendWidth)\n        .attr(\"height\", 10)\n        .style(\"fill\", \"url(#legendTraffic)\");\n        \n      //Append title\n      legendsvg.append(\"text\")\n        .attr(\"class\", \"legendTitle\")\n        .attr(\"x\", 0)\n        .attr(\"y\", -10)\n        .style(\"text-anchor\", \"middle\")\n        .text(vm.legendTitle);\n\n      //Define x-axis\n      const xAxis = vm.getXAxis(vm.legendWidth, maxCount);\n\n      //Set up X axis\n      const axisLayer = legendsvg.append(\"g\")\n        .attr(\"id\", \"axis\")\n        .attr(\"transform\", \"translate(0,\" + (10) + \")\");\n\n      axisLayer.call(xAxis);\n\n      ///////////////////////////////////////////////////////////////////////////\n      /////////////////////// leaflet map zoom events ///////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      vm.map.on(\"zoomend\", () => {\n        updatePath();\n\n      });\n\n      vm.map.on(\"dragend\", () => {\n        updatePath();\n      });\n\n      //pathd\n      const updatePath = function () {\n          // update path\n          g.selectAll(\"path\").attr('d', path);\n\n          const nwPoint = vm.map.latLngToLayerPoint(new L.LatLng(vm.map.getBounds()._northEast.lat, vm.map.getBounds()._southWest.lng));\n\n          // console.log('dragend', nwPoint);\n\n          // update legend\n          g.selectAll(\"g[id=legend_wrapper]\").attr(\"transform\", \"translate(\" + (vm.legendCenterObj.x + nwPoint.x) + \",\" + (vm.legendCenterObj.y + nwPoint.y) + \")\");\n\n          \n      };\n\n      updatePath();\n\n    },\n    getBounds(map) {\n      //Calculate the variables for the sort gradient\n      return {\n        lng_nw: map.getBounds()._southWest.lng,\n        lat_nw: map.getBounds()._northEast.lat,\n        lng_se: map.getBounds()._northEast.lng,\n        lat_se: map.getBounds()._southWest.lat\n      };\n    },    \n    getCountScale(maxCount, width) {\n      //Calculate the variables for the sort gradient\n      return d3.scaleLinear()\n        .domain([0, maxCount])\n        .range([0, width]);\n    },\n    getCountPoints(maxCount, width, size) {\n      //Calculate the variables for the sort gradient\n      const countScale = this.getCountScale(maxCount, width);\n\n      //Calculate the variables for the sort gradient\n      const countRange = countScale.domain();\n      countRange[2] = countRange[1] - countRange[0];\n      const countPoints = [];\n      for(let i = 0; i < size; i++) {\n        countPoints.push(i * countRange[2]/(size-1) + countRange[0]);\n      }\n\n      return countPoints;\n    },\n    getXAxis(legendWidth, maxCount) {\n      const xScale = d3.scaleLinear()\n       .range([-legendWidth/2, legendWidth/2])\n       .domain([ 0, maxCount] );\n\n      return d3.axisBottom()\n              .ticks(5)\n              //.tickFormat(formatPercent)\n              .scale(xScale);\n    },\n    getColorScale(maxCount, colorRange) {\n\n      return d3.scaleLinear()\n        .domain([0, maxCount/2, maxCount])\n        .range(colorRange.split(\",\"));\n    }\n  }\n};\n</script>\n\n\n\n<style>\n\n@import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);\n\nsvg {\n  font-size: 11px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 300;\n  margin: auto;\n  display: block;\n}\n\n.legendTitle {\n  fill: silver;\n  fill-opacity: 1;\n  font-size: 44px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n  text-shadow:\n    2px 2px 0 #000,\n    -1px -1px 0 #000,  \n    1px -1px 0 #000,\n    -1px 1px 0 #000,\n     1px 1px 0 #000;  \n}\n\n.geojsonLabel {\n  display: none;\n  fill-opacity: 1;\n  font-size: 30px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 700;\n  text-anchor: middle;\n  text-shadow:\n    2px 2px 0 #000,\n    -1px -1px 0 #000,  \n    1px -1px 0 #000,\n    -1px 1px 0 #000,\n     1px 1px 0 #000;\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeaf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeaf.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./D3GeoLeaf.vue?vue&type=template&id=494546be&\"\nimport script from \"./D3GeoLeaf.vue?vue&type=script&lang=js&\"\nexport * from \"./D3GeoLeaf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./D3GeoLeaf.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"leaflet\",style:({ height: '100%', width:'100%'}),attrs:{\"id\":\"leaflet\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"leaflet\" ref=\"leaflet\" :style=\"{ height: '100%', width:'100%'}\"></div>\n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport * as topojson from 'topojson';\nimport findprop from '../utils/findprop';\n\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport 'leaflet-providers/leaflet-providers.js';\n\nconst props = {\n  tileProvider: {\n    type: String,\n    default: 'CartoDB.Voyager'\n  },  \n  geojsonObject: {\n    type: Object\n  },\n  color: {\n    type: String,\n    default: 'MidnightBlue'\n  },\n  colorOpacity: {\n    type: String,\n    default: '0.2'\n  },  \n  mapCenter: {\n    type: String,\n    default: '139.77887823700362, 35.69026554219554'\n  },\n  mapZoom: {\n    type: [String, Number],\n    default: 17\n  },  \n  geojsonType: {\n    type: String,\n    default: 'Polygon'\n  },\n  idTag: {\n    type: String,\n    default: 'MESH_ID'\n  },\n  autoFitBounds: {\n    type: Boolean,\n    default: false\n  },\n  hideLabelThreshold: {\n    type: Number,\n    default: 100\n  },\n  highlightedMeshes: {\n    type: Array\n  }    \n};\nexport default {\n  name: 'd3-geo-leaf-polygon',\n  data() {\n    return {\n      map: null,\n      svg: null,\n      mapAdded: false,\n      svgAdded: false,\n    };\n  },\n  props,\n  computed: {  \n  \n  },   \n  watch: {\n    geojsonObject: {\n        handler: function(newVal, oldVal){\n          if (newVal)   {\n            this.renderMap();  \n          } else {\n            this.clearSvg();\n          }\n          \n        },\n        deep: true\n\n    },\n    highlightedMeshes: {\n        handler: function(newVal, oldVal){\n          if (newVal.length > 0)   {\n            this.highlightMesh();  \n          } else {\n            this.clearHighlight();\n          }\n          \n        },\n        deep: true\n\n    }    \n  },\n  mounted () {\n    this.renderMap();\n  },\n  methods: {\n    clearHighlight() {\n      const vm = this;\n\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\");\n\n      const gGeojsonLayer = g.selectAll(`g[id=${this.geojsonType}]`);\n\n      gGeojsonLayer.selectAll(\"path\")     \n        .attr(\"fill-opacity\",\"0\");\n\n    },      \n    highlightMesh() {\n      const vm = this;\n\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\");\n\n      const gGeojsonLayer = g.selectAll(`g[id=${this.geojsonType}]`);\n\n      gGeojsonLayer.selectAll(\"path\")\n        .filter(function(d){\n          console.log(vm.highlightedMeshes.map(ele => ele.mesh_id))\n          return vm.highlightedMeshes.map(ele => ele.mesh_id).includes(String(d.properties[vm.idTag]));\n        })      \n        .attr(\"fill-opacity\", vm.colorOpacity);\n\n    },    \n    clearSvg() {\n      const vm = this;\n\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\");\n\n      g.selectAll(`g[id=${this.geojsonType}]`).remove();\n\n      g.selectAll(`g[id=${this.geojsonType}_label]`).remove();\n\n    },\n    renderMap() {\n      const vm = this;\n\n      // fit bounds based on the geojsonObject\n      if (!this.mapAdded) {\n        if (this.geojsonObject) {\n          vm.map = L.map(this.$refs['leaflet']).fitBounds(L.geoJson(this.geojsonObject).getBounds());\n\n        } else {\n          vm.map = L.map(this.$refs['leaflet']);\n          vm.map.setView(new L.LatLng(this.mapCenter.split(\",\")[1], this.mapCenter.split(\",\")[0]), this.mapZoom);\n        }\n\n        this.mapAdded = true;\n\n        L.tileLayer.provider(vm.tileProvider).addTo(vm.map);\n\n        vm.map.on(\"zoomend\", () => {\n          this.$emit('zoomend', vm.getBounds(vm.map));\n        });\n\n        vm.map.on(\"dragend\", () => {\n          this.$emit('dragend', vm.getBounds(vm.map));\n        });      \n\n        this.$emit('initmap', vm.getBounds(vm.map));        \n      } else {\n        if (this.autoFitBounds) {\n          vm.map.fitBounds(L.geoJson(this.geojsonObject).getBounds());\n        }\n      }\n\n\n      \n      // L.tileLayer.provider('CartoDB.PositronNoLabels').addTo(map);\n      // L.tileLayer.provider('CartoDB.VoyagerNoLabels').addTo(map);\n      // L.tileLayer.provider('Stamen.TonerBackground').addTo(map);\n      // L.tileLayer.provider('Stamen.TonerLite').addTo(map);\n      // L.tileLayer.provider('Hydda.Base').addTo(map);\n      \n      if (!this.geojsonObject) {\n        return;\n      }\n\n\n      ///////////////////////////////////////////////////////////////////////////\n      ///////////////////// create transform and path function //////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const projectPoint = function(x, y) {\n        const point = vm.map.latLngToLayerPoint(new L.LatLng(y, x));\n        this.stream.point(point.x, point.y);\n      };\n\n      const transform = d3.geoTransform({\n          point: projectPoint\n        });\n\n      const path = d3.geoPath().projection(transform);      \n\n\n      ///////////////////////////////////////////////////////////////////////////\n      ///////////////////////////////// add svg /////////////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      if (!this.svgAdded) {\n        L.svg().addTo(vm.map); \n\n        this.svgAdded = true;\n      }\n      \n      ///////////////////////////////////////////////////////////////////////////\n      /////////////////////////// add geojson and label /////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n      const svg = d3.select(vm.map.getPane('overlayPane')).select(\"svg\");\n      const g = svg.select(\"g\").attr(\"class\", \"leaflet-zoom-hide\");\n\n      g.selectAll(`g[id=${this.geojsonType}]`).remove();\n      const gGeojsonLayer = g.append(\"g\").attr(\"id\", this.geojsonType);\n\n      g.selectAll(`g[id=${this.geojsonType}_label]`).remove();\n      const gLabelLayer = g.append(\"g\").attr(\"id\", this.geojsonType + \"_label\");\n\n      const mouseover = function(p, i) {\n        d3.select(this)\n          .style(\"cursor\", \"pointer\")\n          .style(\"stroke-width\", \"3px\")\n\n        gLabelLayer.selectAll(\"text\")\n          .filter(function(d){\n            return d.properties[vm.idTag] == p.properties[vm.idTag];\n          })\n          .transition()\n          .style(\"fill-opacity\", 1)\n          .style(\"display\", \"block\")\n          .attr(\"fill\", function(d,i) {\n            return \"#000000\";\n          });\n      }\n\n      const mouseout = function(p, i) {\n        d3.select(this)\n          .style(\"cursor\", \"\")\n          .style(\"stroke-width\", \"1px\");\n\n        const bbox = gGeojsonLayer.select(\"path\").node().getBBox();\n        if (bbox.width < vm.hideLabelThreshold) {\n          gLabelLayer.selectAll(\"text\")\n            .filter(function(d){\n              return d.properties[vm.idTag] == p.properties[vm.idTag];\n            })\n            .transition()\n            .style(\"fill-opacity\", 0)\n            .transition()\n            .style(\"display\", \"none\");  \n        }\n      }      \n\n      gGeojsonLayer.selectAll(\"path\")\n        .data(this.geojsonObject.features)\n        .enter()\n        .append(\"path\")\n        .attr(\"fill-opacity\",\"0.0\")\n        .style(\"fill\", vm.color)\n        .style(\"stroke-width\", \"1px\")\n        .style(\"pointer-events\", \"auto\")\n        .attr(\"stroke\", function(d,i) {\n          return vm.color;\n        })\n        .on(\"mouseout\", mouseout)\n        .on(\"mouseover\", mouseover);\n\n      this.geojsonObject.features.forEach(function(d) {\n        d.LatLng = new L.LatLng(d.geometry.coordinates[0][1][1],\n          d.geometry.coordinates[0][1][0]);\n      });\n\n      const labels = gLabelLayer.selectAll(\"text\")\n        .data(this.geojsonObject.features)\n        .enter()\n        .append(\"text\")\n        .attr(\"class\", \"geojsonLabel\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"dx\", \"2.5em\")\n        .attr(\"dy\", \"1em\")\n        .style(\"fill-opacity\", 1)\n        .style(\"display\", \"block\")\n        .text(function(d) { \n          return d.properties[vm.idTag];\n        });\n\n      ///////////////////////////////////////////////////////////////////////////\n      /////////////////////// leaflet map zoom events ///////////////////////////\n      ///////////////////////////////////////////////////////////////////////////\n\n      vm.map.on(\"zoomend\", () => {\n        updatePath();\n      });\n\n      vm.map.on(\"dragend\", () => {\n        updatePath();\n      });\n\n      // update path & label\n      const updatePath = function () {\n\n        // update path\n        gGeojsonLayer.selectAll(\"path\").attr('d', path);\n\n        \n\n        // update label\n        labels.attr(\"x\", function(d) {\n          return vm.map.latLngToLayerPoint(d.LatLng).x;\n        });\n\n        labels.attr(\"y\", function(d) {\n          return vm.map.latLngToLayerPoint(d.LatLng).y;\n        });\n\n        const bbox = gGeojsonLayer.select(\"path\").node().getBBox();\n\n        if (bbox.width >= vm.hideLabelThreshold) {\n          labels.style(\"fill-opacity\", 1).style(\"display\", \"block\");\n        } else {\n          labels.style(\"fill-opacity\", 0).style(\"display\", \"none\");\n        }\n        \n          \n      };\n\n      updatePath();\n\n    },\n    getBounds(map) {\n      //Calculate the variables for the sort gradient\n      return {\n        lng_nw: map.getBounds()._southWest.lng,\n        lat_nw: map.getBounds()._northEast.lat,\n        lng_se: map.getBounds()._northEast.lng,\n        lat_se: map.getBounds()._southWest.lat\n      };\n    }\n  }\n};\n</script>\n\n\n\n<style>\n\n@import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);\n\nsvg {\n  font-size: 11px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 300;\n  margin: auto;\n  display: block;\n}\n\n\n.geojsonLabel {\n  display: block;\n  fill-opacity: 1;\n  font-size: 15px;\n  font-family: 'Noto Sans Japanese', 'Klee', 'Meiryo';\n  font-weight: 100;\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeafPolygon.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoLeafPolygon.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./D3GeoLeafPolygon.vue?vue&type=template&id=2d2941ea&\"\nimport script from \"./D3GeoLeafPolygon.vue?vue&type=script&lang=js&\"\nexport * from \"./D3GeoLeafPolygon.vue?vue&type=script&lang=js&\"\nimport style0 from \"./D3GeoLeafPolygon.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n\n\n\n<!-- \n    <d3-geo-double-layer \n      id=\"01\" \n      topojson-path=\"data/tokyo_23_blocks_districts_final.json\"\n      :layer1-event-data=\"districtRankList\"\n      :layer2-event-data=\"circleData\"\n      layer1-event-count-tag=\"dropoffCount\"\n      @on-receive-events=\"subTaxiEventsFrom\"\n      @on-stop-events=\"unsubTaxiEvents\"\n      >    \n    </d3-geo-double-layer>\n-->\n<!--      \n     <d3-geo-events \n      id=\"02\" \n      topojson-path=\"data/tokyo_23_blocks_districts_final.json\"\n      :layer-event-data=\"matrixJson\"\n      >    \n    </d3-geo-events> \n -->\n<!-- \n    <d3-geo-static\n      id=\"03\" \n      topojson-path=\"data/tokyo_23_blocks_districts_final.json\"\n      color-range='#6f97d9,#6f97d9'\n      >    \n    </d3-geo-static>\n\n  -->\n<!--     <d3-geo-static\n      id=\"03\" \n      topojson-path=\"data/states.topojson\"\n      layer-objects=\"states\"\n      layer-feature-name=\"properties.STUSPS\"\n      layer-feature-code=\"properties.NAME\"\n      color-range='#6f97d9,#6f97d9'\n      >    \n    </d3-geo-static> -->\n \n<!--\n    <div>\n      <button @click=\"clearHandler\">clear</button>\n      <div v-for=\"item in apiResponse\">\n        <input type=\"radio\" v-model=\"geojsonString\" name=\"time_window\" :value=\"item.geojson\"> {{item.window_start}}\n      </div>\n    </div>\n\n\n\n    <div style=\"width: 100%; height: 800px\">\n      <d3-geo-leaf\n        tile-provider=\"Stamen.TonerLite\"\n        :geojson-object=\"featureStatistics\"\n        color-range=\"#0000ff,#e623e4,#ff0000\"\n        legend-center=\"400, 50\"\n        :auto-fit-bounds=\"true\"\n        @dragend=\"onDragEnd\"\n        @zoomend=\"onZoomEnd\"\n        @initmap=\"onInit\"\n        >    \n      </d3-geo-leaf>     \n    </div>\n    \n-->  \n\n    <div>\n      <button @click=\"clearHandler\">clear</button>\n      <div v-for=\"item in apiResponse\">\n        <input type=\"radio\" v-model=\"geojsonString\" name=\"area\" :value=\"item.geojson\"> {{item.area}}\n      </div>\n      <button @click=\"highlightHandler\">highlight</button>\n    </div>\n\n     <div style=\"width: 100%; height: 800px\">\n      <d3-geo-leaf-polygon\n        tile-provider=\"Stamen.TonerLite\"\n        :geojson-object=\"featureStatistics\"\n        color=\"#FF6600\"\n        :auto-fit-bounds=\"true\"\n        :highlighted-meshes=\"meshes\"\n        @dragend=\"onDragEnd\"\n        @zoomend=\"onZoomEnd\"\n        @initmap=\"onInit\"\n        >    \n      </d3-geo-leaf-polygon>     \n    </div>\n\n  </div>\n</template>\n\n<script>\nimport D3GeoStatic from './components/D3GeoStatic'\nimport D3GeoDoubleLayer from './components/D3GeoDoubleLayer'\nimport D3GeoEvents from './components/D3GeoEvents'\nimport D3GeoLeaf from './components/D3GeoLeaf'\nimport D3GeoLeafPolygon from './components/D3GeoLeafPolygon'\nimport axios from 'axios'\n\nexport default {\n  name: 'app',\n  components: {\n    D3GeoStatic,\n    D3GeoDoubleLayer,\n    D3GeoEvents,\n    D3GeoLeaf,\n    D3GeoLeafPolygon\n  },\n  computed: {\n    featureStatistics: function() {\n      if (this.geojsonString) {\n        return JSON.parse(this.geojsonString);\n      } else {\n        return null;\n      }\n    }\n  },  \n  data() {\n    return {\n      meshes: [],\n      geojsonString: null,\n      apiResponse: [],\n      currentSubway: null,\n      jsons: [],\n      matrixJson: null,\n      timer: 0,\n      districtRankList: null,\n      circleData: null,\n      coordinates:\n        [[139.734291,35.688634],\n        [139.760496,35.690335],\n        [139.770401,35.694069],\n        [139.765043,35.68835],\n        [139.7661246316267,35.68825974504272],\n        [139.7657681127479,35.687651654673644],\n        [139.745212,35.691125],\n        [139.759712,35.700672],\n        [139.755267,35.693319],\n        [139.761334,35.674706],\n        [139.750424,35.670865],\n        [139.7414532200372,35.679581104938],\n        [139.749899,35.701827],\n        [139.74692,35.696674],\n        [139.740164,35.692643],\n        [139.768072,35.687348],\n        [139.75074,35.671377],\n        [139.743383,35.697602],\n        [139.764721,35.679816],\n        [139.7507934778318,35.671386654224115],\n        [139.7507934778318,35.671386654224115],\n        [139.7507934778318,35.671386654224115],\n        [139.743383,35.697602],\n        [139.7507934778318,35.671386654224115],\n        [139.76294,35.677412],\n        [139.76585163985027,35.68940619519768],\n        [139.761877,35.675639],\n        [139.7507934778318,35.671386654224115],\n        [139.746458,35.671899],\n        [139.74692,35.696674],\n        [139.746458,35.671899],\n        [139.766939,35.683965],\n        [139.737945,35.688772],\n        [139.754544,35.669638],\n        [139.757993,35.692478],\n        [139.750962,35.672238],\n        [139.765683,35.676349],\n        [139.73610888396263,35.68553725865768],\n        [139.73610888396263,35.685537258666734],\n        [139.753961,35.690292],\n        [139.757993,35.692478],\n        [139.752018,35.671321],\n        [139.757993,35.692478],\n        [139.734048,35.684031],\n        [139.742659,35.680767],\n        [139.754544,35.669638],\n        [139.753683,35.698596],\n        [139.750424,35.670865],\n        [139.765854,35.689364],\n        [139.745793,35.692572],\n        [139.745796,35.67096],\n        [139.75463308702805,35.690506392289514],\n        [139.757993,35.692478],\n        [139.76441428407463,35.687749511028905],\n        [139.742659,35.680767],\n        [139.742659,35.680767],\n        [139.754544,35.669638],\n        [139.742824,35.675821],\n        [139.742463,35.678098],\n        [139.744685,35.676487],\n        [139.742463,35.678098],\n        [139.745074,35.675182],\n        [139.7470116382056,35.678418885519754],\n        [139.742463,35.678098],\n        [139.74505617405612,35.67525922701384],\n        [139.74465211932687,35.6765672952068],\n        [139.74505617405615,35.675254401080785],\n        [139.7484141620185,35.67166693581735],\n        [139.752737,35.672691],\n        [139.748046,35.673099],\n        [139.742657,35.67882],\n        [139.748046,35.673099],\n        [139.748046,35.673099],\n        [139.748046,35.673099],\n        [139.748046,35.673099],\n        [139.750157,35.676043],\n        [139.748046,35.673099],\n        [139.742657,35.67882],\n        [139.748046,35.673099],\n        [139.753073,35.673377],\n        [139.745518,35.673015],\n        [139.748046,35.673099],\n        [139.7452951757008,35.67302465399794],\n        [139.762711,35.689542],\n        [139.7406821860937,35.67312691603093],\n        [139.742657,35.67882],\n        [139.742657,35.67882],\n        [139.7453011176821,35.67295707637637],\n        [139.762711,35.689542],\n        [139.748046,35.673099],\n        [139.742657,35.67882],\n        [139.7453011176821,35.67295707637637],\n        [139.743713,35.672988],\n        [139.7541,35.683792],\n        [139.74798931035463,35.67179002702629],\n        [139.75461119813127,35.67567441585073],\n        [139.74071189600025,35.67305209778313],\n        [139.75124,35.675626],\n        [139.75124,35.675626],\n        [139.758656,35.685403]]\n    };\n  },\n  methods: {\n    onDragEnd(bounds) {\n      // console.log('onDragEnd', bounds);\n    },\n    onZoomEnd(bounds) {\n      // console.log('this.onZoomEnd', bounds);\n    },    \n    onInit(bounds) {\n      // console.log('this.onInit', bounds);\n    },      \n    /*** for 2-layer ***/\n    subTaxiEventsFrom(payload) {\n      // console.log('subTaxiEventsFrom');\n      // console.log('payload', payload);\n\n      if (payload == '101') {\n        // console.log('this.timer', this.timer);\n        this.timer = \n          setInterval(() => {\n            var min = 0;\n            var max = this.coordinates.length - 1;\n            var from = Math.floor(Math.random() * (max - min + 1)) + min;\n            var to = Math.floor(Math.random() * (max - min + 1)) + min;\n            var dot;\n            if (from <= to) {\n              dot = this.coordinates.slice(from, to);\n            }\n            else {\n              dot = this.coordinates.slice(to, from);\n            }\n            this.circleData = dot;\n          }, 1500);  \n      }\n    },\n    unsubTaxiEvents() {\n      // console.log('this.timer', this.timer);\n      // console.log('unsubTaxiEvents');\n      clearInterval(this.timer);\n      \n    },\n    generateData() {\n      let districtRank = {};\n      let rank = 1;\n      let i;\n      for (i = 101; i <= 123; i++){\n\n        const min = 0;\n        const max = 500;\n        \n        let count = Math.floor(Math.random() * (max - min + 1)) + min;\n        districtRank[i.toString()] = {district:i, dropoffCount:count, rank: rank};\n        rank++;\n      }\n\n      return districtRank;\n    },\n    /*** for 2-layer ***/\n\n    /*** for route event ***/\n\n    /*** for route event ***/\n    clearHandler() {\n      // this.geojsonString = null;\n      this.meshes = [];\n    },\n    highlightHandler() {\n      this.meshes = [{mesh_id: \"49395630\"}, {mesh_id: \"53393483\"}, {mesh_id: \"53385739\"}, {mesh_id: \"53385759\"}];\n    }    \n  },\n  mounted() {\n    /*** for 2-layer ***/\n    setInterval(() => {\n      this.districtRankList = this.generateData();\n    }, 1000);\n    /*** for 2-layer ***/\n\n    /*** for route event ***/\n    axios.get(\"data/event_data1.json\")\n      .then((response)  =>  {\n        this.jsons.push(response.data.toptenlist);\n      }, (error)  =>  {\n      })\n\n    axios.get(\"data/event_data2.json\")\n      .then((response)  =>  {\n        console.log(response);\n        this.jsons.push(response.data.toptenlist);\n      }, (error)  =>  {\n      })\n\n\n    let count = 0;\n\n    setInterval(() => {\n\n      let idx = Math.floor(Math.random() * 2);\n      this.matrixJson = this.jsons[idx];   \n    }, 1500);\n    /*** for route event ***/\n\n\n    /*** for d3-geo-leaf ***/\n    // setTimeout(() => {\n    //   axios.get(\"data/statistics.json\")\n    //     .then((response)  =>  {\n    //       this.apiResponse = response.data\n    //     }, (error)  =>  {\n        \n    //     });\n\n    // }, 1000);\n    /*** for d3-geo-leaf ***/\n\n    /*** for d3-geo-leaf-mesh ***/\n    setTimeout(() => {\n      axios.get(\"data/tokyo_mesh.json\")\n        .then((response)  =>  {\n          this.apiResponse = response.data\n        }, (error)  =>  {\n        \n        });\n\n    }, 1000);\n    /*** for d3-geo-leaf-mesh ***/\n  }\n}\n</script>\n\n<style>\n\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./app.vue?vue&type=template&id=37fabd53&\"\nimport script from \"./app.vue?vue&type=script&lang=js&\"\nexport * from \"./app.vue?vue&type=script&lang=js&\"\nimport style0 from \"./app.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport app from './app'\n\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(app)\n}).$mount('#app')\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoEvents.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoEvents.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoStatic.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./D3GeoStatic.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}