webpackJsonp([0],[,,function(t,e,a){function r(t){a(15)}var n=a(0)(a(10),a(21),r,null,null);t.exports=n.exports},function(t,e,a){"use strict";e.a=function(t,e){var a,r,n=e.split(".");for(a=0,r=n.length;a<r;a++){if(!t.hasOwnProperty(n[a]))return;t=t[n[a]]}return t}},,,,function(t,e,a){function r(t){a(16)}var n=a(0)(a(11),a(22),r,null,null);t.exports=n.exports},,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(4),n=(a.n(r),a(5)),i=(a.n(n),a(3)),l={id:{type:String,required:!0},topojsonPath:{type:String},width:{type:Number,default:1e3},height:{type:Number,default:1e3},colorRange:{type:String,default:"#e3f2fd,#2196f3,#0d47a1"},center:{type:String,default:"139.752268, 35.677043"},scale:{type:Number,default:11e4},layer1Objects:{type:String,default:"districts"},layer2Objects:{type:String,default:"blocks"},layer1FeatureName:{type:String,default:"properties.district"},layer1FeatureCode:{type:String,default:"properties.district_code"},layer2FeatureName:{type:String,default:"properties.block"},layer2FeatureCode:{type:String,default:"properties.block_code"},layer1EventData:{type:Object,default:null},layer2EventData:{type:String,default:"circleData"},layer1EventCountTag:{type:String,default:"dropoffCount"},layer1LegendTitle:{type:String,default:"３０分以内の降車イベント"},onReceiveEvents:{type:String,default:"subTaxiEventsFrom"},onStopEvents:{type:String,default:"unsubTaxiEvents"}};e.default={name:"d3-geo-double-layer",data:function(){return{legendWidth:0,gLayer1:function(){return{}}}},props:l,mounted:function(){function t(){N.classed("active",!1),N=r.select(null),x.transition().duration(750).style("stroke-width","1.5px").attr("transform",""),S.selectAll("text").transition().style("display","block").transition().duration(250).style("fill-opacity",1),b.selectAll("path").transition().style("fill-opacity",0).style("display","none"),v.$emit(g)}var e=this.width,l=this.height,o=this.layer1Objects,s=this.layer2Objects,c=this.colorRange,u=this.layer1FeatureCode,d=this.layer1FeatureName,p=this.layer2FeatureCode,f=this.layer2FeatureName,y=this.layer1LegendTitle,h=this.onReceiveEvents,g=this.onStopEvents,v=this,m=r.select(this.$el).append("svg").attr("width",e).attr("height",l);m.append("rect").attr("class","background").attr("width",e).attr("height",l).on("click",t);var x=m.append("g"),b=x.append("g").attr("id","layer2"),j=x.append("g").attr("id","layer1"),A=x.append("g").attr("id","layer2_label"),S=x.append("g").attr("id","layer1_label"),C=r.geo.mercator().center(this.center.split(",")).scale(this.scale).translate([e/2,l/2]),_=r.geo.path().projection(C),E=x.append("defs").attr("id","common_grads_def"),F=E.append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id","circleGrad1");F.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),F.append("stop").attr("offset","100%").style("stop-color",function(t){return"orange"}).style("stop-opacity",".6");var w=this.getCountPoints(1,e,10),G=this.getCountScale(1,e);E.append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(r.range(10)).enter().append("stop").attr("offset",function(t,a){return G(w[a])/e}).attr("stop-color",function(t,e){return c.split(",")[0]});x.node().getBBox();this.legendWidth=Math.min(.8*e,600);var k=x.append("g").attr("id","legendWrapper").attr("transform","translate("+e/2+","+.95*l+")");k.append("rect").attr("id","legendRect").attr("x",-this.legendWidth/2).attr("y",0).attr("width",this.legendWidth).attr("height",10).style("fill","url(#legend-traffic)"),k.append("text").attr("class","layer1LegendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(y);var T=this.getXAxis(this.legendWidth,0);k.append("g").attr("id","axis").attr("transform","translate(0,10)").call(T),r.json(this.topojsonPath,function(t,e){var l=n.feature(e,e.objects[o]).features,y=n.feature(e,e.objects[s]).features,h=n.mesh(e,e.objects[o],function(t,e){return t!==e}),g=c.split(",")[0],v=x.append("defs").attr("id","layer1_hgrads").selectAll("radialGradient").data(l).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","100%").attr("id",function(t,e){return"hgrad"+a.i(i.a)(t,u)});v.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),v.append("stop").attr("offset","100%").style("stop-color",function(t,e){return g}).style("stop-opacity","1");var m=x.append("defs").attr("id","layer1_grads").selectAll("radialGradient").data(l).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id",function(t,e){return"grad"+a.i(i.a)(t,u)});m.append("stop").attr("offset","0%").style("stop-color",function(t,e){return g}).style("stop-opacity",".7"),m.append("stop").attr("offset","100%").style("stop-color",function(t,e){return g}).style("stop-opacity","1");var C=function(t){r.select(this).style("fill",function(t){return"url(#hgrad"+a.i(i.a)(t,u)+")"})},E=function(t){r.select(this).style("fill",function(t){return"url(#grad"+a.i(i.a)(t,u)+")"})};b.selectAll("path").data(y).enter().append("path").attr("d",_).attr("fill",function(t,e){return"url(#grad"+a.i(i.a)(t,u)+")"}).style("fill-opacity",0).style("display","none").attr("layer1-feature-code",function(t){return a.i(i.a)(t,u)}).attr("layer1-feature-name",function(t){return a.i(i.a)(t,d)}).attr("layer2-feature-code",function(t){return a.i(i.a)(t,p)}).attr("layer2-feature-name",function(t){return a.i(i.a)(t,f)}).attr("class","layer2").on("click",O).on("mouseover",R).on("mouseout",D),A.selectAll("text").data(y).enter().append("text").attr("class","label").style("fill-opacity",0).style("display","none").attr("transform",function(t){return"translate("+_.centroid(t)+")"}).attr("dy",".35em").attr("pointer-events","none").text(function(t){return a.i(i.a)(t,f)}).attr("layer2-feature-code",function(t){return a.i(i.a)(t,p)}),j.selectAll("path").data(l).enter().append("path").attr("class","layer1").attr("d",_).style("fill",function(t,e){return"url(#grad"+a.i(i.a)(t,u)+")"}).attr("layer1-feature-code",function(t){return a.i(i.a)(t,u)}).attr("layer1-feature-name",function(t){return a.i(i.a)(t,d)}).on("click",P).on("mouseover",C).on("mouseout",E),j.append("path").datum(h).attr("d",_).attr("class","layer1-boundary"),S.selectAll("text").data(l).enter().append("text").attr("class","label").attr("transform",function(t){return"translate("+_.centroid(t)+")"}).attr("dy",".35em").attr("pointer-events","none").text(function(t){return a.i(i.a)(t,d)}).attr("layer1-feature-code",function(t){return a.i(i.a)(t,u)})});var N=r.select(null),O=function(e){if(N.node()&&this.getAttribute("layer1-feature-code")==N.node().getAttribute("layer1-feature-code"))return t()},P=function(e){if(N.node()===this)return t();N.classed("active",!1),N=r.select(this).classed("active",!0),B(e)},B=function(t){var r=_.bounds(t),n=r[1][0]-r[0][0],o=r[1][1]-r[0][1],s=(r[0][0]+r[1][0])/2,c=(r[0][1]+r[1][1])/2,d=.9/Math.max(n/e,o/l),p=[e/2-d*s,l/2-d*c];x.transition().duration(750).style("stroke-width",1.5/d+"px").attr("transform","translate("+p+")scale("+d+")"),S.selectAll("text").transition().style("fill-opacity",0).transition().style("display","none"),b.selectAll("path").transition().style("fill-opacity",1).style("display","block");a.i(i.a)(t,u);v.$emit(h),v.$emit(g)},R=function(t){A.selectAll("text").filter(function(e){return a.i(i.a)(t,p)==a.i(i.a)(e,p)}).transition().style("fill-opacity",1).style("display","block"),r.select(this).style("fill",function(t){return"url(#hgrad"+a.i(i.a)(t,u)+")"})},D=function(t){A.selectAll("text").filter(function(e){return a.i(i.a)(t,p)==a.i(i.a)(e,p)}).transition().style("fill-opacity",0).transition().style("display","none"),r.select(this).style("fill",function(t){return"url(#grad"+a.i(i.a)(t,u)+")"})}},watch:{layer1EventData:function(t,e){this.visualizeLayer1Events(t)}},methods:{visualizeLayer1Events:function(t){var e=this,n=r.entries(t),l=r.max(n,function(t){return t.value[e.layer1EventCountTag]}),o=this.getColorScale(l,this.colorRange),s=this.getCountPoints(l,this.width,10);r.select("#common_grads_def").selectAll("linearGradient").selectAll("stop").attr("stop-color",function(t,e){return o(s[e])});var c=this.getXAxis(this.legendWidth,l);r.select("#axis").selectAll(".tick").remove(),r.select("#axis").call(c),r.select("#layer1").selectAll("path").filter(function(r){if("Feature"===r.type){var n=a.i(i.a)(r,e.layer1FeatureCode),l=t[n];if(!l)return r[e.layer1EventCountTag]=1,!0;var o=l[e.layer1EventCountTag];if(!r[e.layer1EventCountTag])return r[e.layer1EventCountTag]=o,!0;if(o!=r[e.layer1EventCountTag])return r[e.layer1EventCountTag]=o,!0}return!1}),r.select("#layer1_grads").selectAll("radialGradient").selectAll("stop").style("stop-color",function(t,a){return o(t[e.layer1EventCountTag])}),r.select("#layer1_hgrads").selectAll("radialGradient").selectAll("stop").filter(function(t){return"100%"===this.getAttribute("offset")}).style("stop-color",function(t,a){return o(t[e.layer1EventCountTag])}),r.select("#layer1").selectAll("path").filter(function(t){return"Feature"===t.type}).style("fill",function(t,r){return"url(#grad"+a.i(i.a)(t,e.layer1FeatureCode)+")"})},getCountScale:function(t,e){return r.scale.linear().domain([0,t]).range([0,e])},getCountPoints:function(t,e,a){var r=this.getCountScale(t,a),n=r.domain();n[2]=n[1]-n[0];for(var i=[],l=0;l<a;l++)i.push(l*n[2]/(a-1)+n[0]);return i},getColorScale:function(t,e){return r.scale.linear().domain([0,t/2,t]).range(e.split(","))},getXAxis:function(t,e){var a=r.scale.linear().range([-t/2,t/2]).domain([0,e]);return r.svg.axis().orient("bottom").ticks(5).scale(a)}}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(4),n=(a.n(r),a(5)),i=(a.n(n),a(3)),l={topojsonPath:{type:String},width:{type:Number,default:1e3},height:{type:Number,default:1e3},colorRange:{type:String,default:"#0d47a1,#e3f2fd"},center:{type:String,default:"139.752268, 35.677043"},scale:{type:Number,default:11e4},layerObjects:{type:String,default:"districts"},layerFeatureName:{type:String,default:"properties.district"},layerFeatureCode:{type:String,default:"properties.district_code"},featureNameStyle:{type:String,default:"static"}};e.default={name:"d3-geo-staic",props:l,mounted:function(){var t=this.layerObjects,e=this.colorRange,l=this.layerFeatureCode,o=this.layerFeatureName,s=this.featureNameStyle,c=r.select(this.$el).append("svg").attr("width",this.width).attr("height",this.height),u=c.append("g"),d=u.append("g").attr("id",this.layerObjects),p=u.append("g").attr("id",this.layerObjects+"_label");console.log("this.center:",this.center);var f=r.geo.mercator().center(this.center.split(",")).scale(this.scale).translate([this.width/2,this.height/2]),y=r.geo.path().projection(f);console.log("this.topojsonPath:",this.topojsonPath),r.json(this.topojsonPath,function(c,f){console.log("layerObjects:",t);var h=n.feature(f,f.objects[t]).features,g=n.mesh(f,f.objects[t],function(t,e){return t!==e}),v=r.scale.linear().domain([1,h.length]).interpolate(r.interpolateHcl).range(e.split(",")),m=u.append("defs").attr("id",t+"_hdef").selectAll("radialGradient").data(h).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","100%").attr("id",function(t){return"hgrad"+a.i(i.a)(t,l)});m.append("stop").attr("offset","0%").style("stop-color","white").style("stop-opacity","1"),m.append("stop").attr("offset","100%").style("stop-color",function(t,e){return v(e+1)}).style("stop-opacity","1");var x=u.append("defs").attr("id",t+"_def").selectAll("radialGradient").data(h).enter().append("radialGradient").attr("gradientUnits","objectBoundingBox").attr("fx","50%").attr("fy","50%").attr("cx","50%").attr("cy","50%").attr("r","35%").attr("id",function(t){return"grad"+a.i(i.a)(t,l)});if(x.append("stop").attr("offset","0%").style("stop-color",function(t,e){return v(e+1)}).style("stop-opacity",".8"),x.append("stop").attr("offset","100%").style("stop-color",function(t,e){return v(e+1)}).style("stop-opacity","1"),"static"==s){var b=function(t){r.select(this).style("fill",function(t){return"url(#hgrad"+a.i(i.a)(t,l)+")"})},j=function(t){r.select(this).style("fill",function(t){return"url(#grad"+a.i(i.a)(t,l)+")"})};d.selectAll("path").data(h).enter().append("path").attr("d",y).attr("fill",function(t){return"url(#grad"+a.i(i.a)(t,l)+")"}).attr("layer-feature-code",function(t){return a.i(i.a)(t,l)}).attr("layer-feature-name",function(t){return a.i(i.a)(t,o)}).on("mouseover",b).on("mouseout",j),d.append("path").datum(g).attr("d",y).attr("class","layer1-boundary"),p.selectAll("text").data(h).enter().append("text").attr("class","label").attr("pointer-events","none").attr("transform",function(t){return"translate("+y.centroid(t)+")"}).attr("dy",".35em").text(function(t){return a.i(i.a)(t,o)}).attr("layer-feature-code",function(t){return a.i(i.a)(t,l)})}})}}},,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(7),n=a.n(r),i=a(2),l=a.n(i);a.d(e,"D3GeoDoubleLayer",function(){return l.a}),a.d(e,"D3GeoStatic",function(){return n.a})},,function(t,e){},function(t,e){},,,,,function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div")},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div")},staticRenderFns:[]}}],[13]);
//# sourceMappingURL=vue-d3-geo.bb7878c9bfb266fe658e.js.map